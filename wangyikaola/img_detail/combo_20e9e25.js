!function(t,e,i){var o={title:null,content:"",type:"html",width:182,height:0,button:["确定"],css:"",position:"c",method:"append",dragable:0,layout:1,animate:15,timeout:0,init:e.noop,check:e.noop,callback:e.noop},a=t.document,n=e.browser.msie&&e.browser.version<7,r=e.browser.msie,l=0,s={model:1e4,modeless:1e3},d={},c=function(t,i){var o="iDialog"+t,r=/^\*/,l="",s=n&&!i.layout?'<iframe frameborder="0" class="iFrameGround"/>':"",d='<table class="iDialogWrapTable"><tr><td class="itd-top-left"></td><td class="itd-top-center"></td><td class="itd-top-right"></td></tr><tr><td class="itd-mid-left"></td><td class="itd-mid-center"><div class="iDialogContent">',c='</div></td><td class="itd-mid-right"></td></tr><tr><td class="itd-bot-left"></td><td class="itd-bot-center"></td><td class="itd-bot-right"></td></tr></table>',u=i.title===l||null===i.title?l:'<div class="iDialogHead"><h1>'+i.title+"</h1></div>",f=null===i.title?l:'<a class="iDialogClose" hideFocus="true" href="#"></a>',g=0==i.button.length?l:function(){var t=['<div class="iDialogFoot">'],e=i.button,o=e.length,a=0,n=0;for(;a<o;a++)t[a+1]='<a href="javascript:;" rel="'+(o>1?o-a-1:1)+'" class="iDialogBtn'+(r.test(e[a])&&!n?(n++," focusBtn"):l)+'"><span>'+e[a].replace(r,"")+"</span></a>";t[o+1]="</div>";return t.join(l)}(),h=['<div class="iDialog',u?"":" iDialogNoTitle",'" style="visibility:hidden;z-index:',i.zindex,'" id="',o,'">',s,d,u,f,'<div class="iDialogBody"><div class="iDialogMain"></div></div>',g,c,"</div>"].join(l);e(a.body)[i.method](h);return o},u=0,f=function(i,o,r,l){if(!r)return null;var s=a.body,d=e(t),c=n?e("<iframe frameborder='0' class='iFrameGround fullFrameGround'/>").appendTo(s).css("zIndex",o):null,f=e("<div class='iDialogLayout'></div>").appendTo(s).css("zIndex",o),g="fixed"===f.css("position").toLowerCase(),m=!g||c?Math.max(e(s).outerHeight(),d.height(),a.documentElement.clientHeight):0,v=c?Math.max(e(s).outerWidth(),a.documentElement.clientWidth):0;if(r<0||u>0)f.addClass("iOpacityZero").mousedown(function(){h(i);return false});else if(1==r)u++;g||f.height(m);if(c){c.width(v).height(m);f.width(v);e(t).unbind("resize",p).resize(p)}return[f,c]},g=function(i,o,a){if(!i)return;1==o&&u--;for(var n=0;n<2;n++)if(i[n])a?i[n].fadeOut(200,function(){e(this).remove()}):i[n].remove();e(t).unbind("resize",p)},h=function(i){var o=e("#"+i),a=0,n=2*6,r=t.setInterval(function(){o[a%2?"removeClass":"addClass"]("iDialogFlash");++a>=n&&t.clearInterval(r)},100)},m=function(t){n&&t.find(".iFrameGround").css("zIndex",-1).width(t.outerWidth()).height(t.outerHeight())},p=function(){n&&e(".fullFrameGround,.iDialogLayout").width(Math.max(e(a.body).outerWidth(),a.documentElement.clientWidth)).height(Math.max(e(a.body).outerHeight(),e(t).height(),a.documentElement.clientHeight))},v=function(t){var i="string"===typeof t?t:e(t.target).closest(".iDialog")[0].id,o=d,a=o[i],n,r,l,s=0;if(!a)return;n=a.zindex;for(r in o){l=o[r].zindex;if(l<1e4&&l>n){e("#"+r).css("zIndex",l-1);s=l>s?l:s;o[r].zindex=l-1}}if(s){e("#"+i).css("zIndex",s);o[i].zindex=s}},b=function(){var t=d,e=0,i,o,a;for(o in t){a=t[o].zindex;i=a>e?(e=a,o):i}return i},D=function(){var t=b();t&&y("#"+t)},y=function(t){if(n&&!a.hasFocus())return;e(".iDialogBtn[rel=1]",t).focus();e(".focusBtn",t).focus()},w=function(t){if(t&&27==t.keyCode){var i=b(),o=i&&e("#"+i+" .iDialogClose:visible").length;o&&I(i)}},C=false,x=function(){for(var t in d)if(!C){C=true;e(a).keydown(w);return}C=false;e(a).unbind("keydown",w)},k=t.CollectGarbage||e.noop,L=function(i,o,a,n){var l,s="iDialogAniCore",d,c=n||e.noop;if(!a){c.call(i[0]);return}if(a<3){1==o?i.hide()[1==a?"fadeIn":"slideDown"](200,c):i[1==a?"fadeOut":"slideUp"](200,c);return}if(r){i[1==o?"show":"hide"]();c.call(i[0]);return}l="iDialogAnimate"+a;if(1==o){i.addClass(l);t.setTimeout(function(){i.addClass(s);i.removeClass(l);t.setTimeout(function(){i.removeClass(s)},310)},10)}else{i.addClass(s);t.setTimeout(function(){i.addClass(l);t.setTimeout(function(){c.call(i.hide()[0])},325)},1)}},M=function(t){var e=u?-1:1,o={"false":0,"true":e,"-1":-1,0:0,1:e}[t];return o===i?-1:o},z=function(t){var e=t,i=t,o=""=="v";if(t>2){e=parseInt(t/10);i=t-10*e}return o?e:i},F=function(t){var i=e(t).eq(0),o="posMark"+ +new Date;if(!i[0])return null;if(!i[0].orgPosMarkId){i.after("<div style='display:none' id='"+o+"'/>");i[0].orgPosMarkId=o}return i},T=function(a){var n=e.extend({},o,a||{}),r=l++,u,g,h,p,b,D,w=function(i){var o=t.Core;o&&o.linkAutoClick&&e("a[href*=#Core]",g).unbind("click",o.linkAutoClick).click(o.linkAutoClick);if(p.find("iframe:visible").length)p.append('<div class="iDialogDragLayoutHelper"></div>');n.init.call(g[0],i)};n.layout=M(n.layout);n.animate=z(n.animate);if(n.layout){n.zindex=++s.model;s.model++;u=c(r,n);n._layout=f(u,n.zindex-1,n.layout,n.animate)}else{n.zindex=s.modeless++;u=c(r,n);n._layout=null}n.returnValue=null;d[u]=n;g=e("#"+u);!n.layout&&g.mousedown(v);h=e(".iDialogContent",g);p=e(".iDialogMain",g);n.css&&g.addClass(n.css);D=g.css("position");n.width?g.width(n.width):g.addClass("autoWidthDialog");if(n.height){b=p.height()+n.height-g.height();b>0&&p.height(b)}g.css("visibility","visible");switch(n.type){case"html":case"text":p[n.type](n.content);w();break;case"shell":g.html(n.content);w();break;case"frame":g.addClass("iFrameDialog");n.content=n.content+(n.content.indexOf("?")>=0?"&":"?")+"dialogID="+u;p.html('<div class="iFrameLoading">Loading...</div>');e("<iframe scrolling='auto' frameborder='0'/>").addClass("iDialogFrame").insertAfter(p.find(".iFrameLoading")).bind("load",function(){e(".iFrameLoading",p).remove();w(this)}).attr("src",n.content);break;case"ajax":p.html('<div class="iDialogLoading">Loading...</div>').load(n.content,function(t,i,o){var a=true,r=e.safeHTML||function(t){return t};i=!t?"error":i;if("success"!==i&&"notmodified"!==i){g.addClass("iDialogError");p.html("<div>加载远程数据失败（"+(o.status||i)+"）！<br/> URL地址："+r(String(n.content))+"</div>");a=false}g.css(B(n.position,g.width(),g.height(),D));m(g);w(a)});break;case"insert":case"agent":n.orgDom=F(n.content);if(n.orgDom){n.orgDomDisplay=n.orgDom.css("display");("insert"==n.type?p:g).html(n.orgDom.show());w()}else{delete n.orgDom;p.html("没有找到页面内容（"+n.content+"）请检查！");w()}}g.css(B(n.position,g.width(),g.height(),D));y(g);x();e(".iDialogBtn",g).click(function(t){var o=e(this).attr("rel"),a=n.check.call(g[0],+o,this);a=a===i?+o:a;if(false!==a){n.returnValue=a;I(u)}t.preventDefault()});e(".iDialogClose",g).click(function(){I(u);return false});if(e.fn.setControlEffect){e(".iDialogClose",g).setControlEffect("iDialogCloseDown");e(".iDialogBtn",g).setControlEffect("iDialogBtnDown")}n.dragable&&H(g,n.dragable);n.timeout&&t.setTimeout(function(){I(u)},n.timeout);m(g);L(g,1,n.animate);return u},I=function(t){if(t){var i=d[t];if(!i)return;var o=i.callback,r=i.returnValue,l=i.orgDom,s=i.orgDomDisplay;if(i.beforeClose&&false===i.beforeClose(r))return;g(i._layout,i.layout,i.animate);L(e("#"+t),2,i.animate,function(){if(l&&l[0].orgPosMarkId)e("#"+l[0].orgPosMarkId).before(l.css("display",s));e(this).find("iframe").remove();e(this).hide().empty().remove();try{o(r)}catch(t){console.log(t)}l=o=r=null;if(n)a.body.className=a.body.className;k()});delete d[t];i=null;D();x();k()}else for(var c in d)I(c)},H=function(i,o){var a=2==o?i:e(".iDialogHead",i),n,r;if(!a[0]||!o||"move"==a.css("cursor"))return;var l="fixed"==i.css("position").toLowerCase(),s=l?function(t){return{left:t[0].offsetLeft,top:t[0].offsetTop}}:function(t){return t.offset()};a.css("cursor","move").bindDrag({beforeDrag:function(t){var i=e(t.target),o;if({input:1,textarea:1,button:1,select:1,options:1,optgroup:1,a:1,object:1,applet:1}[i[0].tagName.toLowerCase()]||i.closest("a",this)[0]||i.closest("button",this)[0]||i.closest("select",this)[0]||i.closest("object",this)[0]||(o=i.closest("label",this),o[0]&&o.attr("for")))return false},dragStart:function(t){n=s(i);r=[t.pageX,t.pageY];i.css({marginLeft:"auto",marginTop:"auto",left:n.left,top:n.top,right:"auto",bottom:"auto"});e(".iDialogDragLayoutHelper").show()},onDrag:function(t){i.css({left:n.left+t.pageX-r[0],top:n.top+t.pageY-r[1]})},dragEnd:function(o){var a=s(i),n=e(t),r=[n.width(),n.height()],d=[i.width(),i.height()],c=l?[0,0]:[n.scrollTop(),n.scrollLeft()],u={};u.top=Math.max(c[0],Math.min(a.top,r[1]-40+c[0]));u.left=Math.min(r[0]-40+c[1],Math.max(a.left,60-d[0]+c[1]));if(u.top!=a.top||u.left!=a.left)i.animate(u,200);e(".iDialogDragLayoutHelper").hide()}})},E={l:/l/i,t:/t/i,r:/r/i,b:/b/i,c:/c/i},B=function(i,o,a,n){var r=i.constructor,l={},s=e(t),d=[s.width(),s.height()],c,u,f,g,h="auto",m=[0,0],p="fixed"===n,v=E;switch(r){case Array:l.left=i.length>0&&null!==i[0]?i[0]:h;l.top=i.length>1&&null!==i[1]?i[1]:h;break;case Number:if(i<0||i>8)break;c=[0,0,d[0],d[1]];u=[c[0],Math.floor((c[2]+c[0]-o)/2),c[2]-o];f=[c[1],Math.floor((c[3]+c[1]-a)/2),c[3]-a];g=[[u[1],f[1]],[u[0],f[0]],[u[1],f[0]],[u[2],f[0]],[u[2],f[1]],[u[2],f[2]],[u[1],f[2]],[u[0],f[2]],[u[0],f[1]]];if(!p){m[0]=s.scrollLeft();m[1]=s.scrollTop()}l.left=g[i][0]+m[0];l.top=Math.max(g[i][1]+m[1],0);break;case String:if(!p)return B(v.t.test(i)?v.l.test(i)?1:v.r.test(i)?3:2:v.b.test(i)?v.l.test(i)?7:v.r.test(i)?5:6:v.c.test(i)?v.l.test(i)?8:v.r.test(i)?4:0:0,o,a,n);if(/[^cltbr]/i.test(i)||i.length>2)break;l.left=v.l.test(i)?0:v.r.test(i)?(l.right=0,h):(l.marginLeft="-"+o/2+"px","50%");l.top=v.t.test(i)?0:v.b.test(i)?(l.bottom=0,h):(l.marginTop="-"+a/2+"px","50%");break;default:l=i}return l},j=/^iDialog\d+$/;e.dialog=function(t,o){if(t===i)return I();if("string"===typeof t)if(j.test(t)){if(o)(d[t]||{}).returnValue=o;return I(t)}else t={content:t};else if(e.isFunction(t)){o=t;t={}}var a=e.extend({},t||{});if(e.isFunction(o))a.callback=o;return T(a)};e.extend(e.dialog,{position:function(t,i){if(!t)return;var o="auto",a=e("#"+t),n;if(a[0]){n=e.extend({left:o,top:o,bottom:o,right:o,marginTop:o,marginLeft:o},B(i,a.width(),a.height(),a.css("position")));a.css(n)}},bindDrag:function(t,i){if(!t)return;var o=e("#"+t),a=d[t]||{},n=i||a.dragable||1;if(o[0]){H(o,n);a.dragable=n}},unbindDrag:function(t){if(!t)return;var i=e("#"+t),o=i.find(".iDialogHead"),a=d[t]||{};if(i[0]){(2==a.dragable?i:o).unbind("mousedown").css("cursor","");if(2==a.dragable&&!a.layout)i.mousedown(v)}},_cache:function(t){return t?d[t]||{}:{}}})}(window,jQuery);
!function(t,e,o,i,n){var a="NTES_KAOLA_CART_NEW",s="/cartAjax.html",r="NTES_KAOLA_ORDER_FLAG_NEW";e.bjCookies=function(t,o){if(o==n)return e.cookie(t,{path:"/"});else e.cookie(t,o,{path:"/",domain:"kaola.com",expires:365})};o.readyGoToConfirm=function(){e.bjCookies(r,"1")};o.checkConfirmFlag=function(){return!!e.bjCookies(r)};o.addGoodsToCookie=function(t,e,i,n){o.isLogin(function(a){if(a)o.loginUserAddGoods(t,e,null,n);else c(t,e,i,n)})};function c(t,i,n,s){var r=o.innerSource||"OTHER",c=e.bjCookies(a)||"",l=[],d=Date.now(),u=isNaN(i)?1:+i,f,h,m=0,p,g=false,_="",v=50;s=s||"0";if(!c)e.bjCookies(a,[t,u,r,s||"0",d].join("_"));else{f=c.split("|");h=f.length;for(;m<h;m++)if(/^\d+\_\d+\_[^\_]+$/.test(f[m])||/^\d+\_\d+\_[^\_]+\_\S+$/.test(f[m])){p=f[m].split("_");if(p[0]==t&&s==p[3]){g=true;p[1]=Math.min(n?u:+p[1]+u,1e3);p[3]=s||"0";p[4]=d;+p[1]>0&&l[n?"push":"unshift"](p.join("_"))}else l.push(f[m])}if(!g)l.unshift([t,u,r,s||"0",d].join("_"));l=l.slice(0,Math.min(v,l.length));e.bjCookies(a,l.join("|"))}}o.addGoodsInfoToCookie=function(i,n,a,s,r,l){n=n||function(){};o.isLogin(function(e){if(e)o.loginUserAddGoods(i,a,function(e,i){n(r);e&&o.updateCartInfo(i.cartGoodsNum||0);if(i&&i.retcode&&462==i.retcode){o.showStaTip(i.retdesc,"alert",function(){setTimeout(function(){t.location.reload()},600)});return}if(!d(i))return;if(!e&&!!i){o.showStaTip("加入购物车失败了，亲，过会再试试~","alert");return}u()},r);else{c(i,a,false,r);o.loginUserAddGoods(i,a,function(e,a){n(r);e&&o.updateCartInfo(a.cartGoodsNum);if(a&&a.retcode&&462==a.retcode){o.showStaTip(a.retdesc,"alert",function(){setTimeout(function(){t.location.reload()},600)});return}if(!d(a))return;if(!e&&!!a){c(i,0,true,r);o.updateCartInfo();o.showStaTip("加入购物车失败了，亲，过会再试试~","alert");return}u()},r)}});function d(o){if(!!o&&o.retcode&&101==o.retcode){e.dialog({title:"购物车满啦",content:'							<div class="m-dlgcont m-dlgcont-l">								<p class="title">									<i class="iconfont main-icon notice">&#xe609;</i>									'+(o.retdesc||"啊哦~您的购物车商品已满，清理一下再加入新商品吧！")+"								</p>							</div>",width:520,height:0,css:"m-dlgcontwrap-l",animate:15,button:["*暂不清理","去购物车清理"],check:function(e){if(1!=e){t.open("/cart.html","_blank");return false}}});return false}return true}function u(){if(l)s&&o.setSKULayer.doAnim(l.imgurl,l.srcEle)}};var l={};o.loginUserAddGoods=function(t,e,i,n,a){t=isNaN(t)?0:parseInt(t,10);e=isNaN(e)?0:parseInt(e,10);i="function"==typeof i?i:function(){};if(l[t+"_"+e])return i(false);l[t+"_"+e]=true;o.post("/cartAjax/modify.html",{goodsId:t,number:e,innerSource:o.innerSource||"Other",skuId:n||"0",isHuanGou:a||"0"},function(n,a){!n&&(a=o.parseJSON(a));l[t+"_"+e]=false;i(!n&&200==a.retcode,a)},"addGoodsToCart")};o.loginUserRemoveGoods=function(t,e,i,n){o.loginUserAddGoods(t,0,e,i,n)};o.updateCartInfo=function(t){"number"==typeof t?i(t):o.getCartProductNum(function(t){i(t)});function i(t){var o=e("#js_miniCartBox .miniCartNum");o.length&&o[t<=0?"addClass":"removeClass"]("num0").text(t);var i=e(".shopcart .num, .m-shopcart .num,#cartnum,#newcartnum");var n=t<=0?0:t<=99?t:"99+";i.text(n);if(t>0){e(".m-shopcart .w-icon-16,#cartnum").show();e("#newcartnum").text(n)}else e("#newcartnum").text("0")}};o.bindCartMouseEvt=function(){f.init()};o.removeCartItem=function(t,i,n,s){o.isLogin(function(e){if(e)o.loginUserRemoveGoods(t,function(t,e){t&&i(t,e.cartGoodsNum)},n,s);else r()});function r(){var o=e.bjCookies(a)||"",s,r=[];if(t){e.each(o.split("|"),function(e,o){s=o.split("_");if(t!=s[0]||n!=(s[3]||"0"))r.push(s.join("_"))});e.bjCookies(a,r.join("|"));i(true,r.length)}}};var d=false,u=function(t,o,i,n){var a,s;o="function"==typeof o?o:function(){};if(!n&&d)return;n?"":d=true;s=true;e.ajax({url:t,data:i||{},dataType:"json",type:"post",success:function(t){clearTimeout(a);d=false;s&&o(t)},error:function(){clearTimeout(a);d=false;s&&o({error:"error"})}});a=setTimeout(function(){s=false,d=false;o({error:"timeout"})},5e3)},f={html:{nodata:'<div class="cartNone">购物车里还没有商品，{nologin}</div>',nologin:'&nbsp;<a href="javascript:;" name="js_login" class="login_a">登录</a>&nbsp;查看',product:'<div class="cartItem clearfix{_bbNone}" gid="{goodsId}" skuid={skuId}>					<a class="aImg" href="/product/{goodsId}.html">						<img width="50" border="0" height="50" alt="{goodsName}" src="{imageUrl}">					</a>					<div class="pInfoWrap">						<a class="proName" href="/product/{goodsId}.html" title="{goodsName}">{goodsName}</a>					</div>					<div class="priceBox">						<span class="price">¥{currentPrice}</span><br />						<span class="del" name="js_remove">&times;</span>					</div>				</div>',topay:'<div class="checkBox"><p><a class="goCartBtn" href="/cart.html" target="_blank">去购物车结算</a></p></div>',activity:'<h4><em class="{style}">{title}</em>&#12288;<strong>{content}</strong></h4>',dia_top:'<dl class="cartInfo clearfix">					<dt><span class="sign sign7 fl mr10"></span></dt>					<dd>						<p>							<strong class="c_333">添加成功！</strong><br>购物车共有{cartGoodsNum}件商品，合计：							<strong class="c_imp">¥{cartGoodsAmount}</strong>						</p>						<p class="mt10">							<a class="ff_song" href="javascript:;" name="js_close">&lt;&lt; 再逛逛</a>&#12288;							<a class="oPinkBtn" href="/cart.html">去购物车结算</a>						</p>					</dd>				</dl>',dia_product:'<div class="product">							<a href="/product/{goodsId}.html" target="_blank" class="productImg">								<img width="100" border="0" height="100" src="{imageUrlFor100}" alt="{title}" title="{title}">							</a>							<p class="introduceTit">{introduce}</p>							<p class="productTit">								<a target="_blank" title="{title}" href="/product/{goodsId}.html">{title}</a>							</p>							<p class="productPrice">¥{actualCurrentPrice}</p>						</div>'},cart:null,loaded:false,cache_time:3e3,cache_timerid:null,init:function(){var t=this;if(o._orderCore_loadend)return this;o._orderCore_loadend=true;t.cart=e("#js_miniCartBox");if(1==t.cart.length){t.load_depend(function(){t.init_event()});o.updateCartInfo()}return t},load_depend:function(t){t=t||function(){};o.loadCdnCss("/css/ext/jquery.jscrollpane.codrops1.css");o.loadCdnJS(["/js/ext/jquery.mousewheel.js","/js/ext/jquery.jscrollpane.min.js","/js/ext/scroll-startstop.events.jquery.js"],t)},init_event:function(){var t=this,o=t.cart,i;o.click(function(o){var i=e(o.target).closest("[name^=js_]"),n;if(i.length&&(n=i.attr("name")))if("function"==typeof t[n])t[n](i,o)}).mouseenter(function(){clearTimeout(i);i=setTimeout(function(){t.show_cart()},80)}).mouseleave(function(){clearTimeout(i);i=setTimeout(function(){t.hide_cart()},80)})},show_cart:function(){var t=this,o=t.cart,i=e(".miniConWrap",o),n;if(t.loaded){i.removeClass("hide");e("#js_miniCartBox").addClass("miniCartBoxHover")}else{t.load_cart_data(function(){i.removeClass("hide");n=e(".cartList",o);if(n.length&&n.height()>360){n.height(360);n.mousewheel(function(t){t.preventDefault()}).jScrollPane()}i.height(e("div.miniCartCon",o).height());t.show_delIcon(o)});e("#js_miniCartBox").addClass("miniCartBoxHover")}},load_cart_data:function(t){var e=this;u(s,function(o){if(200==o.retcode){e.rander(o.object,t);e.set_loaded()}})},rander:function(t,i){var n=this,a=[],s,r=0,c,l=e(".miniCartCon",this.cart),d,u,f;t=t||{};t.activityGoods=t.activityGoods||[];t.goods=t.goods||[];if(t&&(t.activityGoods.length||t.goods.length)){a.push('<div class="miniCartDetail">');a.push('<div class="cartList">');s=t.goods;while(d=s.shift()){d._bbNone=0==s.length?" bbNone":"";a.push(e.format(n.html.product,d));r++}u=t.activityGoods;while(f=u.shift()){r+=f.goods.length;a.push(n.get_activity_html(f))}a.push("</div>");c=(((t.orderAmount||0)-t.orderActivityAmount).toFixed(2)+"").split(".");a.push(e.format(n.html.topay,{total:r,_monery0:c[0],_monery1:c[1]}));a.push("</div>");l.html(a.join(""));i()}else o.isLogin(function(t){l.html(e.format(n.html.nodata,{nologin:t?"赶快选购吧":n.html.nologin}));i()});o.updateCartInfo(r)},get_activity_html:function(t){var o=[],i=t.goods,n;o.push('<div class="activityWrap">');while(n=i.shift()){n._bbNone=0==i.length?" bbNone":"";o.push(e.format(this.html.product,n))}o.push(this.get_activity_top(t));o.push("</div>");return o.join("")},get_activity_top:function(t){var o={style:"",title:"",content:""},i,n=t.activityType;if(4==n||5==n)o.style="act2",o.title="满赠";else if(12==n)o.style="actTips3",o.title="换购";else o.title="满减";if(t.currentRule){i=t.currentRule.ruleType;o.content="已购满"+t.currentRule.threshold;o.content+=1==i?"件，":"元，";if(6==t.currentRule.activityGiftList[0].giftType)o.content+='<span class="c_imp">已打'+parseFloat(10*(1-t.currentRule.activityGiftList[0].money)).toFixed(1)+"折</span>";else if(12==n)o.content+='可<a href="/cart.html" style="color:#3b6ba0;">换购商品</a>';else o.content+=3==n||11==n?'<span class="c_imp">已减'+t.currentRule.activityGiftList[0].money+"元</span>":"可领取赠品"}if(t.nextRule){if(o.content.length)o.content+="<br/>";i=t.nextRule.threshold-t.currentAmount;i=1==t.nextRule.ruleType?i+"件，":this.p(i)+"元，";o.content+="再购买"+i;if(6==t.nextRule.activityGiftList[0].giftType)o.content+="可打"+parseFloat(10*(1-t.nextRule.activityGiftList[0].money)).toFixed(1)+"折";else if(12==n)o.content+=t.currentRule?"可换购更多商品":"可换购商品";else o.content+=3==n||11==n?"可减"+this.p(t.nextRule.activityGiftList[0].money)+"元":"可领取赠品"}return o.content.length?e.format(this.html.activity,o):""},hide_cart:function(){e(".miniConWrap",this.cart).addClass("hide");e("#js_miniCartBox").removeClass("miniCartBoxHover")},set_loaded:function(){var t=this;t.loaded=true;clearTimeout(t.cache_timerid);t.cache_timerid=setTimeout(function(){t.loaded=false},t.cache_time)},js_remove:function(t){var e=this,i=t.closest("div.cartItem"),n=i.attr("gid"),a=i.attr("skuid")||0;o.removeCartItem(n,function(){e.loaded=false;e.show_cart()},a)},js_login:function(){i.login()},p:function(t){return o.getPriceStr(t||0)},show_cart_dia:function(t){var o=[e.format(f.html.dia_top,t)],i;t.goodsList=t.goodsList||[];if(t.goodsList.length){o.push('<h4>购买过该商品的用户还购买了：</h4><div class="cartProWrap clearfix">');while(i=t.goodsList.shift()){i.actualCurrentPrice=(i.actualCurrentPrice||0).toFixed(2);o.push(e.format(f.html.dia_product,i))}o.push("</div>")}e.dialog();e.dialog({css:"mallCartPop",width:0,title:"",button:[],animate:0,layout:false,dragable:2,content:o.join(""),init:function(){e("a[name=js_close]",this).click(function(){e.dialog()})},beforeClose:function(){e("a",this).unbind();e(this).unbind()}})},show_delIcon:function(t){e("div.cartItem",t).unbind();e("div.cartItem",t).mouseenter(function(){e("span.del",this).show()}).mouseleave(function(){e("span.del",this).hide()})}};e(document).ready(function(){f.init();o.show_cart_dia=function(t){f.show_cart_dia(t)}})}(window,jQuery,Core,easyNav);
!function(t,i,e,r){var s="NTES_KAOLA_RV",n="|",o=20,a=1,l="/recentlyViewAjax.html",c='<li class="{last}"><a class="imgWrap" target="_blank" href="/product/{goodsId}.html"><img src="{url}" border="0" title="{title}"/></a><a class="wrap" href="/product/{goodsId}.html" target="_blank" title="{txtTitle}">{tit}</a></li>',u=t.screen.width;var f=function(t,e){if(arguments.length>1)i.cookie(t,e,{path:"/",domain:"kaola.com",expires:365});else return i.cookie(t,{path:"/"})},h=function(i,e){if(arguments.length>1){t.LS.set(i,e);f(i,e)}else return t.LS.get(i)==r?f(i):t.LS.get(i)};i(function(){var e=i(t),r=i("#userViewRecords");if(r[0]){i(t).resize(function(){r.css("display",e.width()>=1390?"block":"none")});r.css("display",e.width()>=1390?"block":"none")}});e.addBHistory=function(t){var e=h(s),r=(new Date).getTime(),a,l,c=[],u,f=[];if(""==i.trim(e))h(s,t+"_"+r+"_0");else{a=e.split(n);a=i.grep(a,function(i,e){f=i.split("_");if(f[0]==t)return false;else return true});a.unshift(t+"_"+r+"_0");if(a.length>o)a.length=o;h(s,a.join(n))}};e.getBHistoryList=function(){var t=i("#userViewRecords"),r={},o=h(s);if(u>=1390){r.v=a;if(o){arr=o.split(n);i.each(arr,function(t,i){arr[t]=i.split("_")[0]});r.id=arr.join(",")}d(l,r,function(r){var s=[],n=r.length,o=0,a;t.css("visibility",n>0?"visible":"hidden");if(n>0)for(;o<n;o++){a=r[o];a.last=o==n-1?"last":"";a.url=a.imageUrlFor70;a.tit=String(a.title||"").cutString(50,"...");a.txtTitle=a.tit==a.title?"":a.title;s.push(i.format(c,a))}t.find("ul").html(s.join(""));e.resetWrapHeightForHistoryList&&e.resetWrapHeightForHistoryList();e.onHistoryLoaded&&e.onHistoryLoaded()})}};e.getHistoryJsonData=function(t){var e={},r=h(s);e.v=a;if(r){arr=r.split(n);i.each(arr,function(t,i){arr[t]=i.split("_")[0]});e.id=arr.join(",")}if(!e.id){t&&t([]);return}d(l,e,function(i){t&&t(i)})};e.resetWrapHeightForHistoryList=function(){var t=i("#userViewRecords").height(),e=i(".mainWrap");if(e.height()<t)i.isIE6?e.height(t):e.css("min-height",t+"px")};e.clearBHistory=function(t){h(s,"");i(t.target).closest("div").find("ul").html("").end().hide();i(".mainWrap").height("auto");e.resetWrapHeightForHistoryList()};var d=function(t,i,r){if(!i.id)return;e.post(t,i,function(t,i){var s=t?{retcode:999,retdesc:"oh，服务器和考拉私奔了，请重试"}:e.parseJSON(i),n=s.retcode,o=[];switch(n){case 200:r(s.list);break;default:r([])}})}}(window,jQuery,Core);
!function(n,e){var i=function(){this.init=function(n){var e=this.radioFilter(n);if(e.length)this.makenRadio(e)};this.radioFilter=function(e){var i=[];var t=e.length,a=0;for(;a<t;a++)"input"==e[a].tagName.toLowerCase()&&"radio"==e[a].type.toLowerCase()&&""!=e[a].name&&i.push(e[a]);return n(i)};this.makenRadio=function(e){e.each(n.proxy(function(e,i){n(i).wrap(n("<a href='javascript:;' class='wrapnRadio "+(i.checked?"nRadioChecked":"nRadioUnchecked")+"'></a>"))},this));e.each(n.proxy(function(i,t){this.bindEvent(n(t),e)},this))};this.bindEvent=function(e,i){var t=e.parent(),a=i.filter("[name="+e[0].name+"]"),c=n(document).find("label[for="+e.attr("id")+"]");t.click(function(){if(t.hasClass("nRadioChecked"))return;if(c.length)c.click();else o(t,a)});if(c.length)c.click(function(){if(!t.hasClass("nRadioChecked"))o(t,a)});function o(n,e){e.parent(".nRadioChecked").removeClass("nRadioChecked").addClass("nRadioUnchecked").find("input").attr("checked",false);n.removeClass("nRadioUnchecked").addClass("nRadioChecked").find("input").attr("checked",true)}};this.check=function(){alert("sorry!not complete!")}};var t=new i;n.nRadio={init:function(n){t.init(n)},check:function(n){t.check(n)}}}($,window);
!function(t,i){var e={BEGIN:"{{",END:"}}"};if(Regular&&Regular.config)Regular.config(e);var c=Regular.extend({template:"#addrtpl",config:function(t){var i=this;t._display="none";t.loading=true;t.directCitys=t.directCitys||[];t.provinces=[];t.citys=[];t.districts=[];t.curTab=0;t.curSel={province:{},city:{},district:{}};t._ajaxTemp=t._ajaxTemp||{};i.__initData()},init:function(){var t=this,i=t.data;t.$on("show",function(){t.show()});t.$on("toggle",function(){t.toggle()});t.$on("setlocation",function(e){if(i.loading)t.$on("loaded",function(){t.__resetLocation(e,false)});else t.__resetLocation(e,false)})},__initData:function(){var t=this,i=t.data;t.__cacheLoc();t.__initProvCityDists()},__initProvCityDists:function(){var t=this,i=t.data;t.__getProvince(function(){var e=";",c,r,o;for(c=0,r=i.directCitys.length;c<r;c++)e+=i.directCitys[c].code+";";if(!!i.currPvcCode)i.__curSel.province=t.__setLocByCode(i.provinces,i.currPvcCode);for(c=0,r=i.provinces.length;c<r;c++){o=i.provinces[c];o.isDirectCity=e.indexOf(o.code)>-1}});if(!!i.currPvcCode&&!!i.currCityCode){t.__getCity(i.currPvcCode,function(e){i.__curSel.city=t.__setLocByCode(e,i.currCityCode)});t.__getDist(i.currCityCode,function(e){i.currDistCode=0==i.currDistCode?e[0].code:i.currDistCode;i.__curSel.district=t.__setLocByCode(e,i.currDistCode)})}},__cacheLoc:function(t){t=t||{};var i=this,e=i.data;e.__curSel={province:t.province||null,city:t.city||null,district:t.district||null}},__calcWidth:function(t,i){i=i||"name";var e,c,r,o,n=7,a=100;for(e=0,c=t.length;e<c;e++){r=t[e];o=(r[i]||"").length;r.width=a*Math.ceil(o/n)}},__get:function(t,e,c,r){var o=this,n=o.data,a;o.data["loading_"+c]=true;a=function(t){o.data[c]=t.list||[];r&&r.apply(o,[o.data[c]]);if(!n.loading)return;if(!n.currPvcCode&&false==n.loading_provinces||!!n.currPvcCode&&false==n.loading_provinces&&false==n.loading_citys&&false==n.loading_districts){n.loading=false;if(!!n.currPvcCode)o.__setLocation();o.$emit("loaded",{currPvcCode:n.currPvcCode,currCityCode:n.currCityCode,currDistCode:n.currDistCode,provinces:n.provinces,citys:n.citys,districts:n.districts})}};var d=n._ajaxTemp[t+"^_^"+e];if(!!d)a(d);else i.get("/geography/get.html",{code:e,level:t},function(r,d){o.data["loading_"+c]=false;if(r){n.err=true;o.data[c]=[];return}var s=i.parseJSON(d);if(200==s.retcode){n._ajaxTemp[t+"^_^"+e]=s;a(s)}else{n.err=true;o.data[c]=[]}o.$update()})},__getProvince:function(t){this.__get(1,"","provinces",t)},__getCity:function(t,i){var e=this;this.__get(2,t,"citys",function(t){e.__calcWidth(t);i&&i(t)})},__getDist:function(t,i){var e=this;this.__get(3,t,"districts",function(t){e.__calcWidth(t);i&&i(t)})},pvcTabClick:function(t){var i=this,e=i.data;e.act=1},cityTabClick:function(t){var i=this,e=i.data;e.act=2},distTabClick:function(t){var i=this,e=i.data;e.act=3},distClick:function(t,e){i.stop(t);var c=this,r=c.data;this.hide();r.currDistCode=e.code;c.__setLocation();c.__cacheLoc(r.curSel);this.$update()},cityClick:function(t,e){i.stop(t);var c=this,r=c.data;r.currCityCode=e.code;r.currDistCode=0;c.__getDist(r.currCityCode,function(){c.__setLocation()});this.$update()},directCityClick:function(t,e){i.stop(t);var c=this,r=c.data,o;r.currPvcCode=e.code;r.currCityCode=0;r.currDistCode=0;c.__getCity(r.currPvcCode,function(t){if(t&&t.length>0){o=t[0];r.currCityCode=o.code;r.currDistCode=0;c.__getDist(r.currCityCode,function(){c.__setLocation()})}})},pvcClick:function(t,e){i.stop(t);var c=this,r=c.data;r.currPvcCode=e.code;r.currCityCode=0;r.currDistCode=0;c.__getCity(r.currPvcCode,function(){c.__setLocation()})},__bindCloseEvent:function(){var i=this,e=i.data;if(!!e.__hasBindCloseEvent)return;e.__hasBindCloseEvent=true;t("body").click(function(c){var r=c.target,o=i.$refs.addrBox;if(!!r&&!!o&&!t.contains(o,r)&&!e.__isShowingHiding)i.hide(1)})},toggle:function(){var t=this,i=t.data;if("none"==i._display)t.show();else if("block"==i._display)t.hide(1)},__isShowingHiding:function(){var t=this,i=t.data;i.__isShowingHiding=true;t.$timeout(function(){i.__isShowingHiding=false},300)},show:function(){var t=this.data,i=this;i.__isShowingHiding();i.__bindCloseEvent();i.__setLocation(null,true);t._display="block";i.paint();i.$update()},hide:function(t){var i=this,e=i.data;i.__isShowingHiding();e._display="none";if(1===t){e.curSel.province=e.__curSel.province||{};e.curSel.city=e.__curSel.city||{};e.curSel.district=e.__curSel.district||{};e.currPvcCode=e.__curSel.province&&e.__curSel.province.code||0;e.currCityCode=e.__curSel.city&&e.__curSel.city.code||0;e.currDistCode=e.__curSel.district&&e.__curSel.district.code||0;if(!!e.currPvcCode)i.__resetLocation(null,true)}this.$update()},__setLocByCode:function(t,i){for(var e=0,c=t.length,r,o={};e<c;e++){r=t[e];if(true===i){r.selected=true;return r}if(r.code==i){r.selected=true;o=r}else r.selected=false}return o},__resetLocation:function(t,i){var e=this,c=e.data;if(!!t){c.currPvcCode=t.currPvcCode;c.currCityCode=t.currCityCode;c.currDistCode=t.currDistCode||true}e.__getCity(c.currPvcCode,function(){e.__getDist(c.currCityCode,function(){e.__setLocation(t,i);e.__cacheLoc(c.curSel)})})},__setLocation:function(t,i){t=t||{};var e=this,c=e.data,r=t.currPvcCode||c.currPvcCode,o=t.currCityCode||c.currCityCode,n=t.currDistCode||c.currDistCode,a;c.act=false;c.curTab=0;if(r){c.curSel.province=e.__setLocByCode(c.provinces,r);var d=c.curSel.province.name;c.curSel.province.shortName="黑龙"==d.slice(0,2)?"黑龙江":d.slice(0,2);c.curTab=1;a=!!c.curSel.province.isDirectCity}else c.curSel.province={};if(o){c.curSel.city=e.__setLocByCode(c.citys,o);c.curTab=2}else c.curSel.city={};if(n){c.curSel.district=e.__setLocByCode(c.districts,n);c.curTab=3}else c.curSel.district={};if(a)c.curTab=4;if(3==c.curTab||4==c.curTab&&n)!i&&this.$emit("distselect",c.curSel);this.$update()},paint:function(){var i=t(".postage"),e=t(".toWrap",i),c=e.position(),r={width:e.outerWidth(),height:e.outerHeight()};var o=c.left+r.width/2,n=t(this.$refs.addrBox),a=n.outerWidth(),d=0,s=0;if(o>=a/2){d=o-a/2;s=a/2-8}else{d=0;s=o-8}this.data._addrBoxLeft=d+"px";this.data._addrBoxTop=r.height+10+"px";this.data._triUpLeft=s+"px"}}).use("timeout");if("function"===typeof define)define(function(){return c});else if(!!i&&!!i.now)i.AddrBox=c}($,Core);
!function(t,i){var e=Regular.extend({config:function(t){this.data._TOPQTY=99;this.data._STORETHRESHHOLD=10;this.data._WEIGHTMAP={account:1,daily:2,buynowonly:3,perorder:4,store:5};t.loaded=false},skuChange:function(t){var i=this,e=i.data;e._currViewId=t;if(e.loaded)i._calcLimits()},sourceChange:function(t){var i=this,e=i.data;e.loaded=true;e.skuIdMap=t.skuIdMap||{};e.skuVidMap=t.skuVidMap||{};i._calcLimits()},_calcLimits:function(){var t=this._getSkuByViewId(this.data._currViewId),i=this.data,e;if(t)e=this._limitsBySku(t);else e=this._limitsNoSku();i._limitObj=this._getLimitObj(e);this.$emit("limitchange",this.getLimitsInfo())},_limitsBySku:function(t){var i=this.data,e=parseFloat(t.accountLimitBuyCount)||0,a=parseFloat(t.accountBuyCount)||0,n=parseFloat(t.dailyBuyCount)||0,u=parseFloat(t.dailyLimit)||0,r=parseFloat(t.limitBuyOnce)||0,s,o,l=[];if(e){s=e-a;l.push({type:"account",maxQty:s<0?0:s,limit:e,bought:a})}if(u){o=u-n;l.push({type:"daily",maxQty:o<0?0:o,limit:u,bought:n})}if(1===i.isBuyNowOnly)l.push({type:"buynowonly",maxQty:1});if(r)l.push({type:"perorder",maxQty:r,limit:r});l.push({type:"store",maxQty:Math.min(i._TOPQTY,this.getStore())});return l},_limitsNoSku:function(){var t=this.data,i=[];if(1===t.isBuyNowOnly)i.push({type:"buynowonly",maxQty:1});i.push({type:"store",maxQty:Math.min(t._TOPQTY,this.getStore())});return i},_getLimitObj:function(t){var i=this.data;function e(t,e){var a=t.maxQty-e.maxQty;if(0===a)return i._WEIGHTMAP[t.type]-i._WEIGHTMAP[e.type];else return a}t.sort(e);return t[0]},_getSkuByViewId:function(t){if(this.data.skuVidMap&&"string"===typeof t)return this.data.skuVidMap[t]},getStoreAll:function(){return this.getStore("")},getStore:function(t){var i=0,e,a=this.data.skuVidMap,n=[],u,r;if(void 0==t)t=this.data._currViewId;function s(t,i){var e=true;i="_"+i+"_";for(var a=0;a<t.length;a++)if(i.indexOf("_"+t[a]+"_")==-1){e=false;break}return e}if(t)n=t.replace(/^_|_$/g,"").split("_");for(u in a){if(!a.hasOwnProperty(u))continue;e=a[u];r=parseInt(e.currentStore||0);if(0===parseFloat(e.actualStorageStatus))continue;if(n.length)s(n,u)&&(i+=r);else i+=r}return i},_hasMinBuyNum:function(){var t=this._getSkuByViewId(this.data._currViewId),i;if(t){i=parseFloat(t.minBuyNum)||0;return i&&i>1}return false},getMaxQty:function(){return this.data._limitObj.maxQty},getMinQty:function(){var t=this._getSkuByViewId(this.data._currViewId);if(t&&this._hasMinBuyNum())return parseFloat(t.minBuyNum);else return 1},getLimitMsg:function(){var t=this.data._limitObj,i=this.data,e="";switch(t.type){case"account":if(0===t.bought)e="限购"+t.limit+"件";else e="限购"+t.limit+"件(您已购买过"+t.bought+"件)";break;case"daily":if(0===t.bought)e="单日限购"+t.limit+"件";else e="单日限购"+t.limit+"件(已购"+t.bought+"件)";break;case"buynowonly":e="单次仅限购买1件";break;case"perorder":e="单次限购"+t.limit+"件";break;case"store":if(t.maxQty>=i._STORETHRESHHOLD)e="库存充足";else if(t.maxQty<i._STORETHRESHHOLD&&t.maxQty>0)e="库存"+t.maxQty+"件";else e="库存不足"}if(this._hasMinBuyNum()){var a=this.getMinQty(),n=a+"件起售",u="";if("store"===t.type){if(t.maxQty<i._STORETHRESHHOLD+a&&t.maxQty>=a)u="仅剩"+t.maxQty+"件";else if(t.maxQty<a)u="缺货";if(u)e=n+"，"+u;else e=n}else e=n+"，"+e}return e},getLimitsInfo:function(){var t={},i=this.data._limitObj;for(var e in i){if(!i.hasOwnProperty(e))continue;t[e]=i[e]}return{maxQty:this.getMaxQty(),minQty:this.getMinQty(),msg:this.getLimitMsg(),limitObj:t}},hasBuyLimit:function(t){var i=this.data,e=false,a,n=i.skuIdMap,u;if(!!t){u=n[t]||{};if(null!=u.accountLimitBuyCount||null!=u.dailyLimit)e=true}else for(var r in n){if(!n.hasOwnProperty(r))continue;u=n[r];if(null!=u.accountLimitBuyCount||null!=u.dailyLimit){e=true;break}}return e}});if("function"===typeof define)define(function(){return e});else if(!!i&&!!i.now)i.QuantityController=e}($,Core);
!function(e,i,o,t){i.extend(o,{yigouPop:function(){function t(e){return String(e).replace(/([\\\(\)\{\}\[\]\^\$\+\-\*\?\|])/g,"\\$1")}function n(e,i){var o=new RegExp("(?:^|&)"+t(i)+"=([^&$]*)","gi");return o.test(e)?decodeURIComponent(RegExp.$1):""}function s(i){var o=e.location.search.replace(/^\?/g,""),t=o;try{t=decodeURIComponent(o)}catch(s){t=o.replace(/"%26"/g,"&")}return n(t,i)}if(s("from")&&"yigou"==s("from")&&s("uid")&&""!=s("uid")){var a=s("uid"),c=30*60*1e3,l=new Date;l.setTime(l.getTime()+c);i.cookie("KAOLA_MKT_YG_UID",a,{path:"/",domain:"kaola.com",expires:l});var p=["母婴","美食保健","美容彩妆","家居个护","数码家电","服饰鞋包","海外直邮"],r=Math.floor(7*Math.random()),d=i("#yiGouSchemeId").val()||"";i.dialog();i.dialog({title:"签到赢集分宝",content:'<div class="m-yigouIdx">                    				<div class="steps">                    					<ul class="clearfix">                    						<li class="step step-1">找到<span id="categy">'+p[r]+'</span><br/>类目商品</li>                    						<li class="step step-2">在商品详细页面<br/>找到签到按钮</li>                    						<li class="step step-3">完成签到</li>                    					</ul>                    				</div>                    				<div class="cont">    	                				<h3>签到赢规则说明：</h3>    	                				<p class="des">请完整按照流程完成任务并务必在30分钟内完成签到，否则造成签到失败考拉概不负责哦！</p>    	                				<a id="isee" class="w-btn4">我知道了</a>    	                				<p class="tip"><span class="txt">运气真好，有券可以领</span><i class="line"></i></p>    	                				<a id="getCoupon" class="coupon" href="javascript:void(0);"></a>                    				</div>                    		   </div>',width:684,height:575,css:"m-yigouIdxPop",animate:15,button:[],init:function(){i(this).find("#isee").bind("click",function(){i.dialog();return false});i(this).find("#getCoupon").bind("click",function(){o.getCoupon(d+"",10);return false})}})}else;},getCoupon:function(e,t){function n(){o.post("/antiSpamObtainCoupon.html",{schemeId:e},function(e,i){var t=e?{retcode:999,retdesc:"由于服务问题，领取失败"}:o.parseJSON(i),n=t.retcode;if(200==n)o.showSimpleDialog("领取优惠券","yes","领取成功","");else if(n==-3||n==-8||n==-10||n==-19||n==-20||n==-12||n==-22)o.showSimpleDialog("领取优惠券","notice",t.retdesc||"由于服务问题，领取失败","");else o.showSimpleDialog("领取优惠券","fail","领取失败",t.retdesc||"由于服务问题，领取失败")},"getCoupon")}o.isLogin(function(e){if(e){i.dialog();n()}else{i.dialog();easyNav.login(function(e){!e&&n()})}})},showSimpleDialog:function(e,i,t,n){var s="/personal/my_coupon.html";o.showDialog(e,i,t,n,{beforeClose:function(){if("yes"==i)location.href=s},button:"yes"==i?["*立即查看"]:["*确认"]})}})}(window,jQuery,Core);
Core.PromotionTitle=Regular.extend({template:"#promotionTitleTpl",config:function(){var i=this,t=i.data;t.promotions=[];t.loaded=false;t.skuId=void 0;i.$on("changeSku",function(n){t.skuId=n;if(t.loaded)i.__init(n)})},sourceChange:function(i){var t=this,n=t.data;n.loaded=true;n.ajaxData=i;n.newerGift=i.result.newerGift||false;n.goodsForNewer=i.result.goodsForNewer||false;if(!n.noInitOnce||n.skuId)t.__init(n.skuId);n.noInitOnce=false},__init:function(i){var t=this,n=t.data,o=n.ajaxData,e;n.promotions=[];if(i)e=o.skuIdMap[i]||{};else e=o.result||{};t.__initDanpin(e);t.__initZhengdan(e);t.__initTaxReduce(e);t.__initKaolaBean(e);t.__initTaxCoupon(e);t.__dealCoupon();t.__initMaizeng(e);t.$update()},__initMaizeng:function(i){var t=i.maizengPromotionTitleLink||"",n=i.maizengGiftList;if(!t||!n)return;var o=t.split("-");var e="";for(var a=n.length,r,s=0;a;a--,s++){r=n[a-1];r.hasGiftStore=!!r.giftStore&&r.giftStore>0;if(r.hasGiftStore)e+='          <input type="hidden" name="goods[0].goodsActivityGiftListTemp['+s+'].activityGiftId" value="'+r.activityGiftId+'">          <input type="hidden" name="goods[0].goodsActivityGiftListTemp['+s+'].giftType" value="'+r.giftType+'">          <input type="hidden" name="goods[0].goodsActivityGiftListTemp['+s+'].freeNumber" value="'+r.freeNumber+'">          <input type="hidden" name="goods[0].goodsActivityGiftListTemp['+s+'].giftGoodsId" value="'+r.giftGoodsId+'">        '}$(".j-maizengGiftList").html(e);this.data.promotions.push({name:"maizeng",title:o[0]||"",desc:o[1]||"",giftList:n})},__initDanpin:function(i){var t=i.danpinPromotionTitle||"";if(!t)return;var n=t.split("-"),o=n[0],e=n[1];if(0==o.indexOf("限时购"))return;if(0==o.indexOf("特卖"))return;if(0==o.indexOf("秒杀"))return;this.data.promotions.push({name:"danpin",title:o||"",desc:e||"",link:i.danpinPromotionLink})},__initZhengdan:function(i){var t=i.zhendanPromotionTitle||"",n;if(!t)return;n=i.zhendanPromotionLink;if(!!n&&!window.__kaolaIsShowCart&&/.*\/activity\/goods\/\w+\.html/.test(n))n="";var o=t.split("-");this.data.promotions.push({name:"zhengdan",title:o[0]||"",desc:o[1]||"",link:n})},__initTaxReduce:function(i){var t=i.dpReduceTaxPromotionTitleLink||"";if(!t)return;var n=t.split("-");this.data.promotions.push({name:"baoshui",title:n[0]||"",desc:n[1]||""})},__initKaolaBean:function(i){var t=i.kaolaBeanPromotionTitleLink||"";if(!t)return;var n=t.split("-");this.data.promotions.push({name:"klbean",title:n[0]||"",desc:n[1]||""})},__initTaxCoupon:function(i){var t=i.taxCouponStr||"";if(!t)return;this.data.promotions.push({name:"fanquan",link:i.taxCouponLink||"",desc:t||""})},__dealCoupon:function(){var i=this,t=i.data;if(!!t.couponTips)t.promotions.push({name:"coupon",couponList:t.couponTips,btnStr:"更多优惠",btnArr:"&#xe61e;"});var n=t.couponTips||[];for(var o=0,e=n.length;o<e;o++)n[o].show=false},toggleCoupon:function(i){var t=i.couponList||[];for(var n=0,o=t.length;n<o;n++)t[n].show=!t[n].show;if(!!t[0].show){i.btnStr="收起优惠";i.btnArr="&#xe624;"}else{i.btnStr="更多优惠";i.btnArr="&#xe61e;"}}});
!function(t,e,i,o){var n=t.document,a=false,s=function(t,i,o,n,s){var r,l;i="function"==typeof i?i:function(){};if(!n&&a)return;n?"":a=true;l=true;e.ajax({url:t,data:o||{},dataType:s||"json",type:"post",success:function(t){clearTimeout(r);a=false;l&&i(t)},error:function(){clearTimeout(r);a=false;l&&i("json"==s?{error:"error"}:"error")}});r=setTimeout(function(){l=false,a=false;i("json"==s?{error:"timeout"}:"error")},5e3)};e.extend(i,{innerSource:function(){var t=(n.referrer||"").toLowerCase();if(/\/\/[^\/]+?\/search\//.test(t))return"SEARCH";if("specialtopic"==e.getHashPara("from"))return"SPETOPIC";return"DETAIL"}(),isHasContent:false,showTopTipFor:function(i,a,s,r){var l=e("<div class='smallTips "+i+"'><span>"+s+"</span><span class='cusp'></span></div>").appendTo(n.body),c=e(a).offset(),u=l.outerHeight(),d=r==o?5e3:r;l.css({left:c.left,top:c.top-u-12});if(d)t.setTimeout(function(){l.fadeOut(function(){e(this).remove()})},d)},quickInit:function(){this.textareaLazyload();this.lazyLoadImg();i.loadCdnJS(["js/product/pro_pinglun.js","js/product/preview.js"],function(){i.init_navTab();if(t.location.href.indexOf("#P_nav")>0||t.location.href.indexOf("#mainBtmWrap")>0)e("#userRating_T").click();e("#js_toCommnet").click(function(){e("#userRating_T").trigger("click")});i.preview_init("a[name=js_preview]",".commWrap")});this.pro_property()},myInit:function(){i.updateCartInfo();i.initPromotion();i.initQtyController();i.asyncSkuInfo(function(t){i.__asyncSkuInfoReceived=true;i.promotionTitle&&i.promotionTitle.sourceChange(t);i.pdtQtyController.sourceChange(t);i.initNumActiveX()},function(t,e){c.init({qtyController:i.pdtQtyController});i.initAddrComponent();i.initStorageStatus();i.initDiscountMarketprice(t);i.initMemberInfo(t);i.initNewerGift(t);i.initGoodsTips(t);i.__dealCoutingDownBanner=i.dealCoutingDownBanner(t,e);i.__dealCoutingDownBanner()});i.addBHistory(e("#goodsId").val());i.bindCartMouseEvt();this.jumpToAnchor(t.location.search);this.navFix();this.imgActiveX();this.resetSkuMapData(i.sku_map);e(".rateNav input:radio").each(function(t){if(0==t)this.checked=true;else this.checked=false});e.nRadio.init(e(".rateNav input:radio"));e("#js_refresh-recom").click(function(){i.getSeeAgainGoods({node:e(".userBuyView"),quantity:4,strategy:"alsoView"})});i.bind_Tip();if(e.isIE678)e(".m-promotion-desc").each(function(){var t=e(this);if(t.outerWidth()>420)t.css("width","420px")});i.arrivalNotice();if(this.useNewRecommend)this.newRecomFunc();else this.seeAgain();i.stayTimeTrace();i.scrolldaPush();i.initQRApp();i.initYG();i.initFAQFolder();i.initShareAndFav();if("undefined"!==typeof __kaolaExcellentComments){var o=e(".m-excelComm");if(o.find(".tg").length)new r(o)}e(".m-comment-bar").delegate(".comm a","click",function(t){var i=e(this),o=e("#userRating_T");if("1"===i.attr("data-type"))e("#commentSelect1").click();else e("#commentSelect5").click();e("html, body").animate({scrollTop:o.offset().top},300,function(){o.click()})});i.initGtm();e("#qualityvedio").click(function(){i.daEvent("正品保障","button点击","详情页视频")})},textareaLazyload:function(){var t=e("#textareabox"),o=t.attr("data-src"),n=t.find("img");for(var a=0,s=n.length,r;a<s;a++){r=n.eq(a);r.attr("lazyload",i.getImgThumbnail(r.attr("src"),710)).attr("src",o).addClass("img-lazyload")}},initStorageStatus:function(){var t=(i.pdtQtyController.getStoreAll()||0)<=0;if(t){e(".j-instockbuybtns").hide();e(".j-stockoutbuybtns").show();e("a.aAddCart,a.aBuyBtn").remove();e(".m-app-act-pmt").remove()}else{e(".m-app-act-pmt").show();e(".j-commentbar, .j-excelcomm").show()}i.recomStorageStatus(t)},initDiscountMarketprice:function(t){var o=t.result,n=o.currentPrice||0,a=o.marketPrice||0;e("#js_currentPrice span").text(i.getPriceStr(n));var s=e(".j-discountlabel");if(!!s.length&&a>0&&n<a){var r=Math.ceil(n/a*100)/10;if(r<10)s.text(r+"折").show()}else s.hide();var l=e(".j-marketprice");if(!!a)l.show().find("span").text(i.getPriceStr(a));else l.hide()},__refreshDiscountMarketprice:function(t,e){if(!!t)this.initDiscountMarketprice({result:{currentPrice:t,marketPrice:e}})},initMemberInfo:function(t){var i=t.result,o=i.memberCount||0,n=i.memberPrice,a=i.showDiscountCost||false,s=i.memberUnitName||"件",r=i.newerGift||false;var l=o>0&&!!s&&n>=0;if(l)e(".j-membertitle").text(""+o+s+"装").show().next(".j-vline").show();if(l&&a&&null!=n){var c=e(".j-memberlabel");c.find(".unit").text(s);c.find(".fbold").text(Math.round(100*n)/100);c.show();e(".j-newerlabel, .j-discountlabel").remove()}else if(!!r){e(".j-newerlabel").show();e(".j-discountlabel, .j-memberlabel").remove();e(".m-app-act-pmt").remove()}},initNewerGift:function(t){var o=t.result,n=o.newerGift||false,a=o.goodsForNewer||false;var s=e(".j-goodsnotonsale"),r=e(".j-newerbigbtn");if(!!n){e("#js_currentPrice span").text(i.getPriceStr(0)).attr("id","");e("#js_currentPrice").attr("id","");e(".j-stockoutbuybtns, .j-instockbuybtns").remove();r.attr("href",a.activityLink||"").show();e(".aAddCart, .aBuyBtn").remove()}else if(!!s.length)s.show();if(!n)r.remove()},initPromotionBar:function(t){var n=e(".j-promotionbar");if(0==n.length||!t||!t.dachuStartTime)return;var a=n.attr("data-systime"),s=t.dachuStartTime||"",r=t.endTime||"",l=t.promotionMainLink||"",c=t.detailsImageUrl||"",u=t.promotionTitle||"";var d=+i.__createDate(s),f=+i.__createDate(r);if(!s||!r||a>=f){n.remove();return}if(a<d){n.addClass("m-promotionbar-pre");n.find(".price.pre").show()}n.find(".link").attr("href",l);n.find("img.main").attr("src",c);n.find(".slogan").text(u);n.show();var m,p=i.sku_map,h=[],g=e("#js_preprice"),v=e.getUrlPara("skupvs");if(!t.skuPromotionPrePriceMap){n.find(".price.pre").hide();return}for(var y in p){if(!p.hasOwnProperty(y))continue;m=p[y]||{};m.promotionPreprice=t.skuPromotionPrePriceMap[m.skuId]||0;h.push(parseFloat(m.promotionPreprice)||0)}if(g.length>0&&h.sort(function(t,e){return parseFloat(t,10)-parseFloat(e,10)}).length){if(h[0]==h[h.length-1])g.text(i.getPriceStr(h[0]));else g.text(i.getPriceStr(h[0])+"-"+i.getPriceStr(h.pop()));if(!!v){m=p[v];!!m&&m.promotionPreprice!==o&&g.text(i.getPriceStr(+m.promotionPreprice))}}},dealCoutingDownBanner:function(t,o){var n=t,a=o,s=a.promotionSaleItem,r=n.skuIdMap,l=n.skuVidMap;var c=false,u=false,d,f;var m=+new Date;return function(t){if(!n||!a)return;var o={};if(!!t)o=l[t]||{};else o=n.result;var r=i.__getSeckillData(o),p=i.__getTemaiData(o),h=i.__hasTemaiOrXianshi(p),g=!!s&&!!s.dachuStartTime;i.__initDanpinPromotionTitle(o.danpinPromotionTitleLink||"");var v=e(".j-seckill"),y=e(".j-xianshi"),_=e(".j-promotionbar"),w="none";"function"==typeof f&&f.apply();f=null;"function"==typeof d&&d.apply();d=null;i.__hasSeckillActivity=false;if(!!r&&!!r.startTime){d=i.initSeckill(r,m);i.__hasSeckillActivity=true;w="seckill"}else if(1==h||2==h){f=i.initTemaiXianshi(p,1==h,m);w="temai"}else if(g){!u&&i.initPromotionBar(s);w="promotionBar";_.show();u=true}"seckill"!=w&&v.hide();"temai"!=w&&y.hide();"promotionBar"!=w&&_.hide();c=true}},__getSeckillData:function(t){var e=null;if(!!t.seckillActivityGoods)e=t.seckillActivityGoods;else if(!!t.seckillActivityGoodsList&&!!t.seckillActivityGoodsList.length>0)e=t.seckillActivityGoodsList[0];return e},__getTemaiData:function(t){var e={};if(!!t.temaiActivityView)e=t.temaiActivityView;else if(!!t.temaiActivityViewList&&!!t.temaiActivityViewList.length>0)e=t.temaiActivityViewList[0];return e},__initDanpinPromotionTitle:function(t){if(!t)return;var i=t.split("-")[0];if(i.indexOf("直降")>-1)e(".m-price-wrap .m-price-title").text("促销价")},__hasTemaiOrXianshi:function(t){var e=t.activityType||-1,i=t.activityTag||-1;if(9!=e)return 0;return 20==i?1:2},initNumActiveX:function(){e("em[name=js_buyBox]").each(function(t){new l(e(this),{qtyController:i.pdtQtyController})})},asyncSkuInfo:function(o,n){n=n||function(){};i.promotionAsync=i.promotionAsync||{loaded:false,callbackFns:[],skuIdMap:{},skuVidMap:{},result:{},personalCustom:{skuVidMap:{}}};function a(t){var e=t.skuPromotionList||[],i={},o={};for(var n=0,a=e.length,s;n<a;n++){s=e[n];i[s.skuId]=s;o[s.skuPropertyValueId4View||""]=s}return{result:t,skuList:e,skuIdMap:i,skuVidMap:o}}function s(t){for(var e in t){if(!t.hasOwnProperty(e))continue;t[e]()}}function r(){i.promotionAsync.personalCustom=f;var t=f.personalCustomerLimitModels,e={};if(!!t&&t.length>0)for(var o=0,n;o<t.length;o++){n=t[o];e[n.skuPropertyValueId4View||""]=n}i.promotionAsync.personalCustom.skuVidMap=e}var l=false,c=false,u=e("#goodsId").val(),d,f,m=false,p=function(e,o){if(m)return;if("title"==o&&0==h){h++;v();return}else if("item"==o&&0==g){g++;y();return}var n="oh，服务器和考拉私奔了，请刷新页面重试下哦~",a="*知道了";if(1==e);else if(2==e){n="网络信号不佳，请稍后重新刷新页面";a="*刷新"}i.showDialog("提示","forbid",n,null,{button:[a],check:function(){t.location.reload()}});m=true};var h=0,g=0;function v(){i.get("/product/ajax/queryPromotionTitle.html",{goodsId:u},function(t,e){if(t){p(2,"title");return}var u=i.parseJSON(e);if(!!u.success){l=true;d=a(u.data||{});i.promotionAsync.loaded=true;i.promotionAsync.skuIdMap=d.skuIdMap||{};i.promotionAsync.skuVidMap=d.skuVidMap||{};i.promotionAsync.result=d.result;o(d);if(l&&c){r();s(i.promotionAsync.callbackFns);n(d,f)}}else p(1,"title")})}function y(){i.get("/product/ajax/queryPromotionItem.html",{goodsId:u},function(t,e){if(t){p(2,"item");return}var o=i.parseJSON(e);if(!!o.success){c=true;f=o.data||{};if(l&&c){r();n(d,f)}}else p(1,"item")})}v();y()},initQtyController:function(){i.pdtQtyController=new i.QuantityController({data:{isBuyNowOnly:t.__kaolaIsBuyNowOnly}})},initPromotion:function(){var o=e("#j-promotionTitle")[0];if(!o)return;i.promotionTitle=new i.PromotionTitle({data:{couponTips:t.__kaolaCouponTips,noInitOnce:!!e.getUrlPara("skupvs")}});i.promotionTitle.$inject(o)},resetSkuMapData:function(t){function e(t){if(!(t instanceof Array)||0==t.length)return"";t.sort(function(t,e){return parseInt(t,10)-parseInt(e,10)});return"_"+t.join("_")}if("object"!=typeof t)return;var i,o;for(i in t){if(!t.hasOwnProperty(i))continue;if(i){o=e(i.replace(/^_/,"").split("_"));t[o]=t[i];if(i!==o)delete t[i]}}},initShareAndFav:function(){var o=e("#goodsId").val(),n=e(".m-favbtn"),a=false;n.click(function(t){i.stop(t);if(a)return;a=true;!!i.goodsFavAdded?s():r()}).mouseenter(function(){if(!!i.goodsFavAdded)n.find(".txt").text("取消收藏")}).mouseleave(function(){if(!!i.goodsFavAdded)n.find(".txt").text("已收藏")});function s(){i.favDel(o,function(t,e){a=false;if(t){i.showStaTip(e.retdesc||"oh，服务器和考拉私奔了，请重试","fail");return}c();i.goodsFavAdded=false})}function r(){i.favAdd(o,function(o,n){a=false;if(o){i.showStaTip(n.retdesc||"oh，服务器和考拉私奔了，请重试","fail");return}l();i.goodsFavAdded=true;!!t._dapush&&t._dapush("_trackEvent","商品详情页","收藏","弹窗出现",{userAccount:t.easyNav.account||"",userId:t.easyNav.account||""});e.dialog({title:"提示",content:'                        <div class="m-favsucdlg">                            <h3 class="tit">                                <i class="iconfont sucicon">&#xe612;</i>收藏成功！                            </h3>                            <div class="link">                                您可以在&ensp;个人中心&ensp;&gt;&ensp;<a hidefocus="true" href="'+i.domainUrl+'personal/listfavorite.html?zn=favor" target="_blank">我收藏的商品</a>&ensp;查看此商品                            </div>                            <div class="otherfav">                                <h4>喜欢此商品的人还喜欢</h4>                                <div class="otherfavlist" id="j-otherfavlist"></div>                            </div>                        </div>                        ',width:520,css:"commTipsPop m-favsucdlgW",animate:15,button:[],init:function(){var t=new i.PCarousel({data:{goodsList:n.result||[],dspushScroll:["商品详情页","收藏","切换"]}});t.$inject("#j-otherfavlist")}})})}function l(){n.find(".txt").text("已收藏");n.addClass("got").find(".ic").html("&#xe62a;")}function c(){n.find(".txt").text("收藏");n.removeClass("got").find(".ic").html("&#xe62c;")}i.favAdded(o,function(t){if(t){l(n);i.goodsFavAdded=true}else i.goodsFavAdded=false;n.css({display:"inline-block",visibility:"visible"})})},initFAQFolder:function(){var t=e(".m-shipmentfaq");if(0===t.length)return;t.delegate(".fold dt","click",function(){e(this).parent().toggleClass("fold-open")})},initYG:function(){function t(){var t=e.cookie("KAOLA_MKT_YG_UID");return t||""}var o=t();if(!o)return;var n=e(".postage .from").text(),a=["美国","瑞典","日本","德国","法国","英国","巴西","印度","俄罗斯","意大利","加拿大","澳大利亚","西班牙","韩国","墨西哥","印度尼西亚","土耳其","荷兰","沙特阿拉伯","瑞士"],s;do s=a[Math.floor(20*Math.random())];while(new RegExp(s).test(n));if(!s||!n)return;var r=e(".m-yigou-user");r.find(".jfb").bind("click",function(o){i.stop(o);var a='<div class="cont"><p class="title">问题：该商品采购自哪个国家？</p><div class="qas">  <label for="qa1" class="qa1"><input type="radio" name="qaSelect"  id="qa1" value="{ct2}" checked=checked> {ct2}</label>  <label for="qa2"><input type="radio" name="qaSelect"  id="qa2" value="{ct1}"> {ct1}</label></div><div class="btns">  <span class="ok submit">提交</span><span class="cancel">取消</span></div></div>';var r=[s,n][Math.round(Math.random())],l=r==s?n:s;a=e.format(a,{ct1:r,ct2:l});e.dialog({title:"签到赢集分宝",content:a,width:520,height:0,animate:15,css:"m-yigou-jf-tip",button:[],init:function(){e.nRadio.init(e(".m-yigou-jf-tip input:radio"));e(".m-yigou-jf-tip .iDialogMain").delegate(".submit","click",function(){var o=e(".m-yigou-jf-tip input:checked").val();if(o==n){var a=t();if(!a){e.dialog();i.showDialog("签到赢集分宝","fail","签到失败","因为网络等原因，签到失败，请重试。");return}i.get("/getYiGouSignUrl.html?uid="+a+"&hid=5912",null,function(t,o){var n=t?{retcode:999,retdesc:"oh，服务器和考拉私奔了，请重试"}:i.parseJSON(o);if(n&&200==n.retcode&&n.yiGouUrl)location.href=n.yiGouUrl;else{e.dialog();i.showDialog("签到赢集分宝","fail","签到失败","因为网络等原因，签到失败，请重试。");return}})}else{e.dialog();i.showDialog("签到赢集分宝","fail","很遗憾，答错了哦~","请在商品页面寻找答案，继续加油！")}})}})});r.find(".redeem").bind("click",function(t){i.stop(t);i.getCoupon(e("#yiGouSchemeId").val()||"")});r.removeClass("hide")},initAddrComponent:function(){var o,n=e(".postage span.to"),a=e("#goodsId").val();c.initDefHideTomorrowArrival();e(".postage").delegate("span.toWrap","click",function(){!!o&&o.$emit("toggle")});function s(){var s=e(".addr-info")[0];if(o||!s)return;o=new i.AddrBox({data:{directCitys:t.__kaolaDirectCitys||[]}});t.__kaolaDirectCitys=null;o.$inject(s);o.$on("distselect",function(t){var e=t.province,o=t.city,s=t.district;if(s&&s.code){if(!!e.isDirectCity||!o){n.attr("title",e.shortName+s.name);n.html((e.shortName+s.name).slice(0,10))}else{n.attr("title",e.shortName+o.name+s.name);n.html((e.shortName+o.name+s.name).slice(0,10))}i.getPostageTxt(a,o.code,s.code)}})}s();if(i.isSeckillProduct)i.seckillStaticPostage(function(t){if(t&&t.code)!!o&&o.$emit("setlocation",{currPvcCode:t.parentCode,currCityCode:t.code})});else i.getPostageTxt(a,false,false,function(t){!!o&&o.$emit("setlocation",{currPvcCode:t.parentCode||0,currCityCode:t.code||0,currDistCode:(t.children[0]||{}).code||0})})},initQRApp:function(){var t=e(".m-app-act-pmt .qr-anchor").attr("data-wapurl")||"",o=e(".j-m-appbuy").attr("data-wapurl")||"";!!t&&i.initQRAppSeckill(t);!!o&&i.initQRAppBuy(o)},initQRAppSeckill:function(t){var o=e(".m-app-act-pmt .qr-anchor"),n=false;o.one("mouseenter",null,function(o){if(n)return;n=true;i.hoverTip({selector:".m-app-act-pmt .qr-anchor",wrapperClass:"m-app-seckill-tip",width:114,height:114,offsetY:4,offsetX:0});e(".m-app-seckill-tip").css("display","block");i.makeQRCode(e(".m-app-seckill-tip .m-tip-contents"),t,114,114);e(".m-app-seckill-tip").css("display","none");e(o.target).trigger("mouseenter")})},initQRAppBuy:function(t){var o=e(".j-m-appbuy");i.makeQRCode(o.find(".qrcodeic"),t,128,128)},arrivalNotice:function(){var t=new RegExp("(^1[3|4|5|7|8|]\\d{9}$)|(^1[3|4|5|7|8|][0-9]{1}[*]{4}[0-9]{4}$)");i.noticePhonePass=false;function o(){e(".phoneErr").empty().hide()}function a(t){e(".phoneErr").text(t).show()}e(n).delegate(".btn-arrivalNotice","click",function(t){i.afterLogin(function(){e.dialog({title:"到货通知",content:'<div class="noticeText">若该商品到货，您将收到手机短信通知，提醒您及时购买！</div>                                   <div class="phoneInput"><input class="c_ccc" type="text" value="请输入接收通知的手机号" autocomplete="off" /></div>                                   <div class="phoneErr hide"></div>',width:520,height:294,css:"commTipsPop",animate:15,button:["*设置到货通知"],check:s,init:function(){var t=e(this);if(e.cookie("arrNotPho"))t.find(".phoneInput input").removeClass("c_ccc").val(e.cookie("arrNotPho")).blur();t.find(".iDialogMain").css({paddingBottom:5});t.find(".iDialogFoot").css({paddingBottom:40}).find("a").css({padding:"5px 20px"}).find("span").css({fontSize:"18px"})}})})}).delegate(".phoneInput input","focus",function(t){var i=e(this);if("请输入接收通知的手机号"==i.val().trim()){i.val("");i.removeClass("c_ccc")}o()}).delegate(".phoneInput input","blur",function(n){var s=e(this);if(""==s.val().trim()){a("不能为空！");s.val("请输入接收通知的手机号").addClass("c_ccc");i.noticePhonePass=false}else if(t.test(s.val())){o();i.noticePhonePass=true}else{a("请填写正确的手机号码！");i.noticePhonePass=false}});function s(){if(!i.noticePhonePass){if(!e(".phoneErr").is(":visible"))e(".phoneInput input").blur();return false}var t=i.getLoginUserInfoFromCookie.checkCurrentStatus().ursId,o=e(".phoneInput input").val().trim(),n=e("#goodsId").val().trim(),a=e("input[name=goods[0].skuId]").eq(0).val().trim();i.post("/stockreg.html",{email:t,phoneNo:o,goodsId:n,skuId:a},function(t,o){if(t){r("fail");return}var n=i.parseJSON(o);switch(n.retcode){case 0:e.cookie("arrNotPho",n.result,{path:"/",expires:365*10});r("yes");break;case 8:r("yes");break;default:r("fail")}})}function r(t){var o,n;e.dialog();if("yes"==t)o="设置成功";else{o="设置失败";n="因为网络等原因，设置失败，请重试。"}i.showDialog("到货通知",t,o,n)}},switchNoGoods:function(t){if(i.isSeckillProduct||e("a.newerBtn").length>0||!!i.__hasSeckillActivity||e(".j-Not4SaleBuyBtn").length>0)return;if("show"==t)e("#noGoods").show().siblings(".buyBtns").hide();else e("#noGoods").hide().siblings(".buyBtns").show()},__createDate:function(t){var i=e.map(t.split(/[^0-9]/),function(t){return parseInt(t,10)});return i.length>1?new Date(i[0],i[1]-1||0,i[2]||1,i[3]||0,i[4]||0,i[5]||0,i[6]||0):new Date},__dig2:function(t){return 1==(t+"").length?"0"+t:t},initSeckill:function(o,n){var a=e(".j-seckill"),s=a.find(".j-seckill-cnt");if(a.length<1)return;var r=this.__createDate,l=this.__dig2;var u=o.seckillPrice,d=o.startTime||"",f=o.nowToStartMillis||-1,m=o.nowToEndMillis||-1,p=1==(o.buyType||0),h=o.soldout||false,g=o.afterSelloutGoodsId||"",v=o.promotionTitle||"",y=o.pcLandingPage,_=o.marketPrice;var w={time:""};var k=e(".j-xianshi-remind",a);this.__remindPhoneSeckill(k,w);if(m<=0||!d){a.hide();return}var x=e(".j-seckill-landingPage");if(!!y)x.find(".other-seckills").attr("href",y).show();else x.hide();s.find(".u-desc").html(v);var b=e(".j-seckill-canbuy");b.html('                <span class="j-seckillAbout2Begin seckillAbout2Begin" style="display:none">敬请期待</span>                <div class="j-seckillToBuy seckillToBuy" style="display:none">                    <span>该活动商品已抢光，下次早点来哦</span>                </div>                <span class="btn-nogoods f-seckillhide">暂时缺货</span>                <span class="btn-arrivalNotice f-seckillhide"><b></b>到货通知</span>                ');if(!!g){var C='<span>原商品正在低价促销中，请</span><a href="/product/'+g+'.html" target="_blank">点击此处</a>';e(".j-seckillToBuy").html(C)}e("#noGoods").hide().siblings(".buyBtns").show();var T=0,I=0;var S=r(d);var P=n||+new Date;var j=a.find("[data-state=01]"),A=a.find("[data-state=4]"),D=a.find("[data-state=5]"),B=a.find("[data-state=6]");var L={min:A.find(".min"),sec:A.find(".sec"),milsec:A.find(".milsec")};var M={day:D.find(".day"),dayw:D.find(".dayw"),hour:D.find(".hour"),min:D.find(".min"),sec:D.find(".sec"),milsec:D.find(".milsec")};var q=e("#buyBtn, a.aBuyBtn"),N=!q.hasClass("buynowonly"),R=e(".m-price-wrap .m-price-title"),E=e("#addCart, a.aAddCart"),O=e("#buyBtn, a.aBuyBtn, #addCart, a.aAddCart, .btn-nogoods, .btn-arrivalNotice, .newerBtn");var F,G;var U=false;var H=function(){var t=c.get_now_vid();if(0==i.pdtQtyController.getStore(t)){U=true;O.addClass("f-seckillhide");b.find(".btn-nogoods").removeClass("f-seckillhide");if(!!i.sku_map[t])b.find(".btn-arrivalNotice").removeClass("f-seckillhide")}};var z={0:function(){w.time=l(S.getMonth()+1)+"月"+l(S.getDate())+"日"+l(S.getHours())+":"+l(S.getMinutes());a.find(".u-xianshi-counter .price").text("￥"+u);j.show().siblings("[data-state]").hide();j.find(".time").text(w.time);s.removeClass("xianshi-red").removeClass("xianshi-grey").addClass("xianshi-blue");k.show();R.text("售价");s.removeClass("xianshi-counting");if(!p){O.addClass("f-seckillhide");e(".j-seckillAbout2Begin").show()}else H();G=setTimeout(function(){a.show()},0)},1:function(){this[0]();w.time="明日"+l(S.getHours())+":"+l(S.getMinutes());j.find(".time").text(w.time)},2:function(){this[1]();w.time=l(S.getHours())+":"+l(S.getMinutes());j.find(".time").text(w.time)},3:function(){this[2]();if(!p)e(".j-seckillAbout2Begin").text("即将开始");k.hide()},4:function(){this[3]();j.hide();A.show();s.addClass("xianshi-counting")},"4itv":function(t){var e=Math.max(t._toStartMs,0),o=i.getTimeDescription(e,true);L.min.text(o.mm);L.sec.text(o.ss);L.milsec.text(("000"+e).slice(-3,-2))},5:function(){this[4]();A.hide();D.show();s.removeClass("xianshi-blue").addClass("xianshi-red").addClass("xianshi-counting");R.text("秒杀价");q.removeClass("f-seckillhide").addClass("buynowonly").text("立即秒杀");E.addClass("f-seckillhide");if(!p){if(u>=0&&_>0)i.__refreshDiscountMarketprice(u,_);e(".j-seckillAbout2Begin").hide();H()}else if(U)q.addClass("f-seckillhide")},"5itv":function(t){var e=Math.max(t._toEndMs,0),o=i.getTimeDescription(e,true);if("00"==o.dd){M.day.hide();M.dayw.hide()}else{M.day.text(o.dd).show();M.dayw.show()}M.hour.text(o.hh);M.min.text(o.mm);M.sec.text(o.ss);M.milsec.text(("000"+e).slice(-3,-2))},6:function(t){a.show();clearInterval(t.itv);B.show().siblings("[data-state]").hide();s.removeClass("xianshi-blue").removeClass("xianshi-red").addClass("xianshi-grey");if(!p){O.addClass("f-seckillhide");e(".j-seckillAbout2Begin").hide();e(".j-seckillToBuy").show()}else H()},7:function(e){clearInterval(e.itv);t.location.reload()}};var Q=5*60*1e3,V=3*Q;var W=10,X=0;function $(t,e){var i=new Date(+e+1e3*60*60*24);return i.getDate()==t.getDate()}var J,Y,K,Z,te,ee,ie=false;var oe=setInterval(ne,100);ne();function ne(){J=new Date;Y=+J;if(X++%W==0){K=$(S,J);Z=S.getDate()==J.getDate()}te=f-(Y-P);ee=m-(Y-P);var e={};T=0;if(K)T=1;if(Z)T=2;if(te<=V&&te>Q)T=3;else if(te<=Q&&te>0){e._toStartMs=te;T=4}else if(te<=0&&ee>0){e._toEndMs=ee;T=5;if(h)T=6}else if(ee<=0){T=7;e.itv=oe}if(0==T){!ie&&z[T](e);ie=true}else if(T>I){if(4==I&&5==T||4==I&&6==T){t.location.reload();I=T;return}I=T;z[T](e)}else if(T==I)z[T+"itv"]&&z[T+"itv"](e)}return function ae(){clearInterval(oe);clearTimeout(F);clearTimeout(G);k.unbind();R.text("售价");q.text("立即购买");N&&q.removeClass("buynowonly");E.removeClass("f-seckillhide");O.removeClass("f-seckillhide");b.html("");if(!p)e(".j-seckillAbout2Begin, .j-seckillToBuy").hide()}},__remindPhoneSeckill:function(t,o){var n=e(t),a=n.attr("data-goodsId");n.unbind();i.loadCdnJS(["js/common/regphone2.js"],function(){n.click(function(){i.regPhoneNum(a,o.time)})})},__remindPhoneTemai:function(t,o,n,a){var s=e(t),r=s.attr("data-goodsId");s.unbind();i.loadCdnJS(["js/common/regphone.js"],function(){s.click(function(){i.regPhoneNum2({temaiType:1,goodsId:r,tabId:o,price:n,startTime:a})})})},__remindPhoneXianshi:function(t,o){var n=e(t),a=n.attr("data-goodsId");n.unbind();i.loadCdnJS(["js/common/regphone.js"],function(){n.click(function(){i.regPhoneNum2({temaiType:2,goodsId:a,tabId:o})})})},initTemaiXianshi:function(o,n,a){var s=e(".j-xianshi"),r=s.find(".j-xianshi-cnt");if(s.length<1)return;var l=this.__createDate,c=this.__dig2;var u=o.activityPrice,d=o.startTime||"",f=o.nowToStartMs||-1,m=o.nowToEndMs||-1,p=o.tabId,h=o.urlMsg,g=o.activitUrl,v=o.promotionTitle||"";if(m<=0||!d){s.hide();return}if(v.indexOf("-")==-1){s.find(".j-u-title").hide();s.find(".j-u-split").hide();s.find(".j-u-desc").html(v)}else{var y=v.split("-"),_=y[0],w=v.replace(_+"-","");s.find(".j-u-title").html(_).show();!!w&&s.find(".j-u-split").show();s.find(".j-u-desc").html(w)}var k=e(".j-xianshi-link");if(!!h&&!!g){k.find(".xianshi-link").attr("href",g);k.find(".j-xianshi-msg").html(h);k.show()}else k.hide();var x=e(".j-xianshi-remind",s);if(!!p)if(!!n){x.text("开抢提醒");this.__remindPhoneTemai(x,p,u,d)}else{x.text("开场提醒我");this.__remindPhoneXianshi(x,p)}var b=0,C=0;var T=l(d);var I=a||+new Date;var S=s.find("[data-state=0]"),P=s.find("[data-state=3]"),j=s.find("[data-state=4]");var A={min:P.find(".min"),sec:P.find(".sec"),milsec:P.find(".milsec")};var D={day:j.find(".day"),dayw:j.find(".dayw"),hour:j.find(".hour"),min:j.find(".min"),sec:j.find(".sec"),milsec:j.find(".milsec")};var B;var L={0:function(){s.find(".u-xianshi-counter .price").text("￥"+u);S.show().siblings("[data-state]").hide();S.find(".time").text(c(T.getMonth()+1)+"月"+c(T.getDate())+"日"+c(T.getHours())+":"+c(T.getMinutes()));r.removeClass("xianshi-red").addClass("xianshi-blue");r.removeClass("xianshi-counting");e(".m-price-wrap .m-price-title").text("售价");B=setTimeout(function(){s.show()},0);if(!!p)x.show();else x.hide()},1:function(){this[0]();S.find(".time").text("明日"+c(T.getHours())+":"+c(T.getMinutes()))},2:function(){this[1]();S.find(".time").text("今日"+c(T.getHours())+":"+c(T.getMinutes()))},3:function(){this[2]();x.hide()},4:function(){this[3]();S.hide();P.show();r.addClass("xianshi-counting")},"4itv":function(t){var e=Math.max(t._toStartMs,0),o=i.getTimeDescription(e,true);A.min.text(o.mm);A.sec.text(o.ss);A.milsec.text(("000"+e).slice(-3,-2))},5:function(){this[4]();P.hide();j.show();r.removeClass("xianshi-blue").addClass("xianshi-red").addClass("xianshi-counting");e(".m-price-wrap .m-price-title").text("抢购价")},"5itv":function(t){var e=Math.max(t._toEndMs,0),o=i.getTimeDescription(e,true);if("00"==o.dd){D.day.hide();D.dayw.hide()}else{D.day.text(o.dd).show();D.dayw.show()}D.hour.text(o.hh);D.min.text(o.mm);D.sec.text(o.ss);D.milsec.text(("000"+e).slice(-3,-2))},6:function(e){clearInterval(e.itv);t.location.reload()}};var M=5*60*1e3,q=3*M;var N=10,R=0;function E(t,e){var i=new Date(+e+1e3*60*60*24);return i.getMonth()==t.getMonth()&&i.getDate()==t.getDate()}var O=false;var F,G;var U=setInterval(H,100);H();function H(){var e=new Date,i=+e;if(R++%N==0){G=E(T,e);F=T.getMonth()==e.getMonth()&&T.getDate()==e.getDate()}var o=f-(i-I);var n=m-(i-I);var a={};b=0;if(G)b=1;if(F)b=2;if(o<=q&&o>M)b=3;else if(o<=M&&o>0){a._toStartMs=o;b=4}else if(o<=0&&n>0){a._toEndMs=n;b=5}else if(n<=0){b=6;a.itv=U}if(0==b){!O&&L[b](a);O=true}else if(b>C){if(5==b&&4==C){t.location.reload();C=b;return}C=b;L[b](a)}else if(b==C)L[b+"itv"]&&L[b+"itv"](a);else L["6"](U)}return function z(){clearInterval(U);clearTimeout(B);x.unbind();e(".m-price-wrap .m-price-title").text("售价")}},initGoodsTips:function(t){var i=e(".buynowonly-wrap");if(!i.length)return;var o=i.attr("data-showCoverTax"),n=i.attr("data-showNoReturnGoods"),a=i.attr("data-showUseCoupon"),s=i.attr("data-isShowCart"),r=i.attr("data-refundDays")||7,l="0";var c=t.result||{},u;if(!!c.seckillActivityGoods){u=c.seckillActivityGoods.nowToStartMillis||0;if(u>0&&"1"==s)l="1"}r=0==r?7:r;var d={sarr:[l,o,n,!n,a],starr:["本商品秒杀期间，不支持购物车结算","本商品税费≤50，直接下单可免税","本商品不支持7天无理由退货","本商品支持"+r+"天无忧退货","本商品不支持使用优惠券"],mtarr:["秒杀期间，不支持购物车结算","税费≤50，直接下单可免税","不支持7天无理由退货","支持"+r+"天无忧退货","不支持使用优惠券"]},f,m,p,h,g=0,v;var y="",_=e(".buynowonly-tip-lis",i);for(f=0,p=d.sarr.length;f<p;f++)if("1"==d.sarr[f]){g++;v=f}if(1==g){y+="<li>"+d.starr[v]+"</li>";_.append(y)}else if(g>1){var w=true;for(f=0,m=1;f<p;f++)if("1"==d.sarr[f]){h=d.mtarr[f];if(w&&h.indexOf("本商品")<0)y+="<li>"+m++ +"."+"本商品"+h+"</li>";else y+="<li>"+m++ +"."+h+"</li>";w=false}_.append(y)}else i.remove()},bind_Tip:function(){var t=e("#overAmount"),i=e(".over-amt-alert .tip-wrap"),o;if(t.length<1||i.length<1)return;t.mouseenter(function(){i.show()});t.mouseleave(function(){o=setTimeout(function(){i.hide()},300)});i.mouseenter(function(){clearTimeout(o)});i.mouseleave(function(){o=setTimeout(function(){i.hide()},300)})},init_navTab:function(){var i={navBox:e("#P_nav span"),activeB:e("#goodsDetail_T")},o=function(t,e){if(n.createEventObject)try{var i=n.createEventObject();return t.fireEvent("on"+e,i)}catch(o){}else{var i=n.createEvent("HTMLEvents");i.initEvent(e,true,true);return!t.dispatchEvent(i)}};i.navBox.bind("click",function(){if(!e(this).hasClass("active")){var n=e(this).attr("id");e(this).addClass("active");i.activeB.removeClass("active");e("#"+i.activeB.attr("id").replace("_T","")).hide();e("#"+n.replace("_T","")).show();i.activeB=e(this);if("userRating_T"==n){e("#goodsQA").hide();e("#priceIntro").hide()}else if("goodsQA_T"==n){e("#priceIntro").hide();e("#userRating").hide()}else{e("#priceIntro").show();e("#userRating").show();e("#goodsQA").show()}e(t).scrollTop(e(".goodsDetailWrap").offset().top+e("#js_zuhetuijie").height());o(t,"resize")}})},imgActiveX:function(){var o={upUl:e("#litimgUl"),upUlMaxW:0,allLi:e("#litimgUl li"),nowLi:e("#litimgUl li").eq(0),show:e("#showImg"),litimgUp:e("#litimgUp"),litimgDown:e("#litimgDown"),showImgBox:e("#showImgBox"),showDetails:e("#showDetails"),imgShadow:e("#showImgBox b"),showImg:e("#showImgBig"),ulLeft:0,imgOffset:e("#showImgBox").offset(),mousePosition:function(t){if(t.pageX||t.pageY)return{x:t.pageX-o.imgOffset.left,y:t.pageY-o.imgOffset.top};return{x:t.clientX-o.imgOffset.left+n.body.scrollLeft-n.body.clientLeft,y:t.clientY-o.imgOffset.top+n.body.scrollTop-n.body.clientTop}}};t.onresize=function(){o.imgOffset=e("#showImgBox").offset()};o.imgOffset=e("#showImgBox").offset();var a=80*e("#litimgUl li").length,s=o.upUl.width();o.upUl.css("width",a);o.upUlMaxW=Math.round(a-s);o.allLi.mouseenter(function(){o.nowLi.removeClass("active");e(this).addClass("active");o.nowLi=e(this);var t=e(this).find("img").attr("src")||"";var n=i.getImgThumbnail(t.split("?")[0],400);var a=i.getImgThumbnail(t.split("?")[0],800);o.show.attr("src",n);o.showImg.attr("src",a);e("#showLocalImg").attr("href",a)});o.litimgUp.bind("click",function(){if(!e(this).hasClass("scrollDis")){o.ulLeft+=80;if(0==o.ulLeft)e(this).addClass("scrollDis");o.upUl.animate({left:o.ulLeft+"px"},300);o.litimgDown.removeClass("scrollDis")}});o.litimgDown.bind("click",function(){if(!e(this).hasClass("scrollDis")){o.ulLeft-=80;if(o.ulLeft==-o.upUlMaxW)e(this).addClass("scrollDis");o.upUl.animate({left:o.ulLeft+"px"},300);o.litimgUp.removeClass("scrollDis")}});o.showImgBox.mousemove(function(e){var i=e||t.event;var n=o.mousePosition(i);if(n.x>100&&n.x<300){o.imgShadow.css("left",n.x-100+"px");o.showImg.css("left",2*-(n.x-100)+"px")}else if(n.x>=300){o.imgShadow.css("left","200px");o.showImg.css("left","-400px")}else{o.imgShadow.css("left","0px");o.showImg.css("left","0px")}if(n.y>100&&n.y<300){o.imgShadow.css("top",n.y-100+"px");o.showImg.css("top",2*-(n.y-100)+"px")}else if(n.y>=300){o.imgShadow.css("top","200px");o.showImg.css("top","-400px")}else{o.imgShadow.css("top","0px");o.showImg.css("top","0px")}o.imgShadow.show();o.showDetails.show()}).mouseenter(function(){e(".buydisabled").hide();e(".goods_max_tip").remove()});o.showImgBox.mouseleave(function(){o.imgShadow.hide();o.showDetails.hide();e(".buydisabled").show()})},navFix:function(){var i=e(t),o=e("#P_nav"),n=e(".goodsDetailWrap"),a=e("a.aAddCart,a.aBuyBtn"),s=function(){var t=i.scrollTop(),e=n.offset().top;if(t>=e){o.addClass("P_navFix");a.css("display","inline-block");if("absolute"==o.css("position"))o.css("top",t-e-3)}else{o.removeClass("P_navFix");a.css("display","none");o.removeAttr("style")}};var r=e.throttle(s,50,{leading:false});i.scroll(r);r()},addToCart:function(o,n,a,s,r){t["_gaq"].push(["_trackEvent","购物车点击","商品详情页"]);if(i._add2CartLock)return;if(e("#addCart").hasClass("addcartdis")||e("#addCart").hasClass("disabled"))return;if(!c.check()){s&&e(t).scrollTop(e("#js_skuBox").offset().top);return}i._add2CartLock=true;var l=+(e.trim(e(".ctrnum-qty").val()).replace(/\D/g,"")||"1")||1;i.addGoodsInfoToCookie(a,function(){i._add2CartLock=false
},l,true,e("input[name=goods[0].skuId]").val(),{imgurl:e("#showImg").attr("src"),srcEle:r})},buyNow:function(o){var n=e("#buyBtn").closest("form");var a=parseFloat(n.find("[name='goods[0].tempCurrentPrice']").val());var s=parseInt(e(".ctrnum-qty").val());n.find("[_name=innerSource]").val(this.innerSource);if(e("#buyBtn").hasClass("disabled"))return;if(!c.check()){if(e(o.target).closest("#P_nav").length)e(t).scrollTop(e("#js_skuBox").offset().top);return}if(t.__isXmasPkg&&t.__xmasBeginTime>t.__systemTime){i.showDialog("提示","notice","该商品于11.11日0点 开抢，敬请期待！",null,{button:["*知道了"]});return}function r(t){i.check_xiangou(t,function(){if(l())return;i.readyGoToConfirm();n[0].submit()})}function l(){if(!i.promotionAsync||!i.promotionAsync.personalCustom)return true;var t=i.promotionAsync.personalCustom.skuVidMap[c.get_now_vid()]||i.promotionAsync.personalCustom||{};var o=parseInt(t.isPersonalCustom||0),n=parseInt(t.personalCustomLimitBuyCount||0),a=t.personalCustomInfoStr||"",s=e("[name=js_buyBox] input.ctrnum-qty"),r=parseInt(s.val())||0;if(1==o&&r>n){s.val(n);s.trigger("focusout");e.dialog({title:"提示",content:'                        <div class="noticeText">'+a+'</div>                        <div class="noticeText">您已超限，请分开购买哦~</div>                        ',width:520,height:275,css:"m-limitBuyTipsPop commTipsPop",animate:15,button:["*知道了"],init:function(){}});return true}return false}if(i.isSeckillProduct){function u(t){i.getSeckillToken(function(e){n.find('[name="token"]').val(e);r(t)})}this.isLogin(function(t){if(t)u(true);else easyNav.login(function(t){if(!t)u(false)})})}else this.isLogin(function(t){if(t)r(true);else easyNav.login(function(t){if(!t)r(false)})})},buyNow2:function(t){var o=e("#buyBtn").closest("form").attr("target","_blank");o.find("[_name=innerSource]").val(this.innerSource);i.readyGoToConfirm();o[0].submit()},renderXiangouDia:function(t){var o=i.pdtQtyController.getLimitsInfo();var n=e("input.ctrnum-qty"),a=parseInt(n.val(),10),s=o.limitObj.bought,r=o.maxQty,l="";if("account"!==o.limitObj.type&&"daily"!==o.limitObj.type){e.isFunction(t)&&t();return}if(!isNaN(s)&&!isNaN(r)){if(r>=a){e.isFunction(t)&&t();return}if("account"===o.limitObj.type)if(r>0)l='抱歉，这件商品每人最多可购买<span class="xiangou-txt-qty"> '+(s+r)+' </span>，您已经购买了<span class="xiangou-txt-qty"> '+s+' </span>件, 只能再购买<span class="xiangou-txt-qty"> '+r+" </span>件哦~";else l='抱歉，这件商品每人最多可购买<span class="xiangou-txt-qty"> '+(s+r)+' </span>件哦~您已经购买了<span class="xiangou-txt-qty"> '+(s+r)+" </span>件, 不能再购买了。";else if("daily"===o.limitObj.type)l='抱歉，此商品单日限购<span class="xiangou-txt-qty"> '+(s+r)+' </span>件，您单日已购买<span class="xiangou-txt-qty"> '+s+" </span>件, 超出限购了哦~~";e.dialog({title:"提示",content:"<div class='xiangou-err-wrap'>                    			<span class='sign refresh-err-icon'>&#xe609;</span>                    			<span class='xiangou-err-txt'>"+l+"</span>                    		</div>",width:520,button:["*知道啦~"],animate:15})}},check_xiangou:function(t,o){if(i.isSeckillProduct)t=false;var n=e("input[name=goods[0].skuId]").val();if(!i.pdtQtyController.hasBuyLimit(n)){e.isFunction(o)&&o();return}if(t)i.renderXiangouDia(o);else i.asyncSkuInfo(function(t){i.pdtQtyController.sourceChange(t);i.renderXiangouDia(o);e("input.ctrnum-qty").focusout()})},jumpToAnchor:function(e){if(e&&e.split("=")[1]&&"articlepage"==e.split("=")[1])t.location.hash="#articlepage"},add_activity:function(){var t,i=[];e.get("/goodsAjax/getGoodsPageShowActivity.html?goodsId="+e("#goodsId").val(),function(o){if(200==o.retCode&&o.infoList instanceof Array){o.infoList.length&&i.push('<div class="mb10">');while(t=o.infoList.shift())i.push(e.format('<div class="tc">                        						<a href="{imgHyperLink}" target="_blank">                        							<img src="{imgUrl}">                        						</a>                        					</div>',t));i.length&&i.push("</div>");i.length&&e("#goodsDetail h3.productAd").after(i.join(""))}},"json")},showRecommondGoods:function(t,e){s("/goodsRecommendAjax.html",function(e){if(200==e.retcode&&(e.list||[]).length)i.randerRecommondHtml(e.list,""==t?"惊爆特价":"根据浏览为您推荐")},{goods_ids:t,isAlwaysRecom:e})},randerRecommondHtml:function(t,o){var n,a=[],s=e("#recommondWrap");a.push("<h3><strong>"+o+"</strong></h3><div class='productsView clearfix'>");while(n=t.shift())a.push(i.getRecommondHtml(n));a.push("</div>");s.html(a.join(""))},getRecommondHtml:function(t){var o=e(".btmWrap #from").val(),n=['<div class="product">'],a,s,r,l,c;if(t.recommendReason)n.push('<a href="/product/'+t.goodsId+".html"+(""==o?"":"#from="+o)+'" target="_blank" class="introDetail" style="opacity: 0;">                			<em></em><span>'+t.recommendReason+"</span>                			</a>");n.push('<a class="productImg" target="_blank" href="/product/'+t.goodsId+".html"+(""==o?"":"#from="+o)+'">            			<img width="150" height="150" border="0" title="'+t.title+'" alt="'+t.title+'" src="'+i.getImgThumbnail(t.imageUrl,150)+'">');if(0==t.actualStorageStatus)a="stockoutIcon";if(a)n.push('<span class="'+a+'"></span>');n.push("</a>");n.push('<p class="introduceTit">'+t.introduce+"</p>");n.push('<p class="productTit">            				<a href="/product/'+t.goodsId+".html"+(""==o?"":"#from="+o)+'" title="'+t.title+'" target="_blank">'+t.title+'</a>            			</p>            			<p class="productPrice clearfix">            				<span class="price">¥'+i.getPriceStr(t.actualCurrentPrice)+"</span>            			</p>");n.push('<p class="productActLink">');if(t.activityLinkList)n.push(t.activityLinkList.join(""));n.push("</p>");n.push("</div>");return n.join("")},pro_property:function(){var t=e("#goodsDetail"),i,o=e("ul.goods_parameter",t),n,a,s;if(0==t.length||0==o.length)return;s=e("li",o).eq(0);i=2*s.outerHeight();if(e("li",o).length>6){a=o.height();n=i;o.height(i);e("h4.goodsParaTit a.zk",t).show().click(function(){if(e(this).hasClass("sq")){e(this).removeClass("sq").find(".txt").html("展开 ");o.height(n)}else{e(this).addClass("sq").find(".txt").html("收起 ");o.height(a)}})}},getPostageTxt:function(t,o,n,a){var r=e("#feeTxt"),l={goodsId:t},c,u;if(!!o&&!!n){l.cityCode=o;l.districtCode=n;e.bjCookies("SHIPPING_TO_CITY_CODE_NEW",o)}s("/postage/get.html",function(t){if(t&&200==t.retcode&&t.postage){if(t.shippingTo&&t.shippingTo.code&&e.isFunction(a)){e.bjCookies("SHIPPING_TO_CITY_CODE_NEW",t.shippingTo.code);a(t.shippingTo)}if("不配送"==t.postage)r.html('<strong class="notDeliver">该地区暂不支持配送</strong>');else{u=t.merchantDeliverStr||"";if(!!u)u='&emsp;<span class="merchantdesc">'+u+"</span>";if(!!t.postageDetail){c='<span class="arron iconfont"></span><span class="arroff iconfont"></span>';r.html('<span class="u-postage"><i class="fee">'+t.postageShowStr+c+'</i><i class="desc">'+t.postageDetail+"</i></span>"+u)}else r.html('<span class="postagedesc">'+t.postageShowStr+"</span>"+u)}i._tomorrowArrival(t)}else r.html("<strong>数据获取失败，请刷新页面重试</strong>")},l,true)},_tomorrowArrival:function(t){var o=t.tomorrowArrivalStatus,n=t.divisionTimeStr||"",a=t.arrivalTimeStr,s=e(".j-tomorrowArrival");if(0==s.length)return;if(0==o){i.__tomorrowArrivalShow=false;s.hide()}else{i.__tomorrowArrivalShow=true;s.show();s.find(".j-divisionTime").text(n);s.find(".j-arrivalTime").text(a)}var r=c.getCurAsyncSku();if(i.__isInitHideTomorrowArrival||!r&&i.__isDefHideTomorrowArrival||r&&!!r.preSaleRemindStr||i.__isSkuHideTomorrowArrival){i.__isInitHideTomorrowArrival=false;s.hide()}s.find(".j-txt").hide();if(1==o){s.find(".j-tomorrow, .j-arrdetail").show();s.find(".j-after").hide()}else if(2==o){s.find(".j-tomorrow").hide();s.find(".j-after, .j-arrdetail").show()}else if(3==o){s.find(".j-tomorrow, .j-after, .j-arrdetail").hide();s.find(".j-divisionTime").text("24:00")}else if(4==o)s.find(".j-txt").text(a).show().siblings().not(".m-line-title").hide()},show_limit_tips:function(){var t=e("[name=js_buyBox] input.ctrnum-qty");if("0"===t.attr("maxcount")){i.showTopTipFor("goods_max_tip buydisabled",t[0],"限购"+(t.attr("buycount")||1)+"件，您已达限购数",3e3);t.trigger("focusout")}},recomStorageStatus:function(t){var o,n=~~e("#goodsId")[0].value;if(t);else{o={node:e("#pro_actBuy"),quantity:6,strategy:"viewBuy",loc:"REC_LOC_PC_GOODS_DETAIL",from:"detailklzzm",query:"rp=detail&zp=klzzm&zn=rec&recId="};i.getSeeAgainGoods(o);i.scrollToRecommendTj("#pro_actBuy",["商品详情页","看了最终买"],true,{position:"商品详情页面：最终购买（DETAIL）",items:6,resource:"挖掘组"});e(".j-sidegraybox").show()}},newRecomFunc:function(){var t=~~e("#goodsId")[0].value;var i={node:e("#pro_relPur"),quantity:5,params:{strategy:"bindBuy",goods_id:t,limit:5,ver:2,loc:"REC_LOC_PC_GOODS_DETAIL"},callback:"",from:"detailmlym",from2:"",query:"rp=detail&zp=mlym&zn=rec&recId="};this.newRecommend(i);this.scrollToRecommendTj("#pro_relPur",["商品详情页","买了又买"],true,{position:"商品详情页面：相关推荐（DETAIL）",items:6,resource:"挖掘组"});var o={node:e("#pro_seeAga"),quantity:6,strategy:"alsoView",from:"detailklyk",loc:"REC_LOC_PC_GOODS_DETAIL",query:"rp=detail&zp=klyk&zn=rec&recId="};this.getSeeAgainGoods(o);this.scrollToRecommendTj("#pro_seeAga",["商品详情页","看了又看"],true,{position:"商品详情页面：看了又看（DETAIL）",items:6,resource:"挖掘组"});var n={node:e("#pro_hotSale"),quantity:5,strategy:"hotSale",from:"detailphb",query:"rp=detail&zp=phb&zn=rec&recId="};n.url="/product/hotsales.html";this.getSeeAgainGoods(n);this.scrollToRecommendTj("#pro_hotSale",["商品详情页","排行榜"],true,{position:"商品详情页面：热销排行榜（DETAIL）",items:5,resource:"挖掘组"});var a={node:e("#pro_gueLov"),quantity:4,params:{strategy:"fav",limit:4,ver:2},callback:"",from:"detailcnxh",from2:"",category:"gueLov",query:"rp=detail&zp=cnxh&zn=rec&recId="};this.newRecommend(a);this.scrollToRecommendTj("#pro_gueLov",["商品详情页","猜你喜欢"],true,{position:"商品详情页面：猜你喜欢（DETAIL）",items:4,resource:"挖掘组"});var s={node:e("#pro_recBow"),quantity:4,from:"detailzjll",tongji:["_trackEvent","推荐区域展示","商品详情页","最近浏览"],query:"rp=detail&zp=zjll&zn=rec&recId="};this.newHistoryRecommend(s);this.scrollToRecommendTj("#pro_recBow",["商品详情页","最近浏览"],true,{position:"商品详情页面：最近浏览（DETAIL）",items:4,resource:"考拉产品组"});this.clickRecommendTj()},seeAgain:function(){i.scrollToRecommendTj(".mainBtmWrap .userBuyView","商品详情页",true,{position:"商品详情页面：左侧热门推荐（DETAIL）",items:4,resource:"挖掘组"});i.getSeeAgainGoods({node:e(".userBuyView"),quantity:4,strategy:"alsoView",loc:"REC_LOC_PC_GOODS_DETAIL",query:"rp=detail&zp=klyk&zn=rec&recId="})},seeAgainTpl:'<li class="clearfix {bbNone}" data-item={itemData}>                        {rank}                        <a href="{productUrl}" data-param="{productUrlParam}" target="_blank" class="aImg"><img border="0" src="{imageUrlThumbnail}" alt="{hoverTitle}" title="{hoverTitle}" /></a>                        {promotion}                        <p class="productTit">                         <a class="aTit" target="_blank" title="{hoverTitle}" href="{productUrl}" data-param="{productUrlParam}">{displayTitle}</a>                        </p>                        <div class="clearfix">                            <p class="productPrice"><span>¥{actualCurrentPrice}</span><del>¥{marketPrice}</del></p>                            <p class="commentCount"><a href="{commentUrl}" data-param="{commentUrlParam}" target="_blank">{commentCount} 人已评价</a></p>                        </div>                       </li>',getSeeAgainGoods:function(o){var n={strategy:o.strategy,goods_id:~~e("#goodsId")[0].value||"",limit:o.quantity,account:i.getAccount()||"",from:"pc",ver:2};if(!!o.loc)n.loc=o.loc;i.post(o.url||"/recommend/getRecommendGoods.html",n,function(n,a){var s=n?{retcode:999,retdesc:"oh，服务器和考拉私奔了，请重试"}:i.parseJSON(a),r=s.retcode,l,c;switch(r){case 200:var u=[],d=0;if(s.list&&s.list.length>0)e.each(s.list,function(n,a){if(0!=a.actualStorageStatus&&1==a.onlineStatus){var r="/product/"+(a.goodsId||"")+".html",f=r,m=t.encodeURIComponent(a.reason||""),p,h;if(o.query){p=o.query+m;h=p+"#mainBtmWrap"}else{p="from=detailfp";h="#mainBtmWrap"}if(a.memberCount&&a.memberCount>0){l="<b>"+a.memberCount+(a.memberUnitName||"件")+"装</b>&nbsp;|&nbsp;";c=a.memberCount+(a.memberUnitName||"件")+"装&nbsp;|&nbsp;"}else{l="";c=""}var g="";if("alsoView"==o.strategy&&!!a.saleShow)g="<p class='promotion'><span title='"+(a.saleShow||"")+"'>"+(a.saleShow||"")+"</span></p>";var v="";if("hotSale"==o.strategy)v="<b class='rank'>"+ ++d+"</b>";itemData=JSON.stringify({id:a.goodsId||"",recType:a.recType||"",reason:m,weight:a.weight||""});u.push(e.format(i.seeAgainTpl,{bbNone:n==s.list.length-1?"bbNone":"",productUrl:r,productUrlParam:p,imageUrlThumbnail:i.getImgThumbnail(a.imageUrl,158)||"",displayTitle:l+(a.title||""),hoverTitle:c+(a.title||""),actualCurrentPrice:a.actualCurrentPrice||"",marketPrice:a.marketPrice||"",commentUrl:f,commentUrlParam:h,commentCount:a.commentCount||0,promotion:g,itemData:itemData||"",rank:v||""}))}if(n==o.quantity-1)return false});if("detailphb"==o.from&&u.length<5){o.node.parent().remove();return}o.node.html(u.join(""))}})},stayTimeTrace:function(){var o=e("#goodsId").val();function n(t){i.post("/productStay/"+o+".html?type="+t,{},function(t,e){})}n("in");e(t).focus(function(t){n("in")}).blur(function(t){n("out")})},scrolldaPush:function(){!!e(".j-rankMark").length&&!!t._dapush&&t._dapush("_trackEvent","商品详情页","榜单标识图",e("#goodsId").val(),{userAccount:t.easyNav.account||"",userId:t.easyNav.account||""});var o=e("#pro_relPur")[0];i.scroll2daPush(o,"商品详情页","相关推荐",function(){return i.getGoodsIdList(o,".newRecomItemWrap")});var n=e("#pro_seeAga")[0];i.scroll2daPush(n,"商品详情页","看了又看",function(){return i.getGoodsIdList(n,"li")},2e3);var a=e("#pro_actBuy")[0];i.scroll2daPush(a,"商品详情页","看了最终买",function(){return i.getGoodsIdList(a,"li")},2e3);var s=e("#pro_hotSale")[0];i.scroll2daPush(s,"商品详情页","热销排行榜",function(){return i.getGoodsIdList(s,"li")},2e3);var r=e("#pro_gueLov")[0];i.scroll2daPush(r,"商品详情页","猜你喜欢",function(){return i.getGoodsIdList(r,".newRecomItemWrap")});var l=e("#pro_recBow")[0];i.scroll2daPush(l,"商品详情页","最近浏览",function(){return i.getGoodsIdList(l,".newRecomItemWrap")})},initGtm:function(){i.gtmReady({com_data:{page_type:"product",goods:t._goodsData||{}}})}});function r(t){this.commObj=t;this.commList=__kaolaExcellentComments;this.upTg=t.find(".up");this.upTgEnable=false;this.downTg=t.find(".down");this.downTgEnable=1===this.commList.length?false:true;this.tit=t.find(".tit");this.detail=t.find(".detail");this.currIdx=0;this.switching=false;this.bindEvents();__kaolaExcellentComments=null}r.prototype.bindEvents=function(){var t,e=this;this.commObj.mouseenter(function(i){clearInterval(e.autoInterval);clearTimeout(t);t=setTimeout(function(){e.showDetail()},300)});this.commObj.mouseleave(function(i){clearTimeout(t);e.setAutoSwitch();t=setTimeout(function(){e.shrinkDetail()},500)});this.upTg.click(function(t){e.prev()});this.downTg.click(function(t){e.next()});this.setAutoSwitch()};r.prototype.setAutoSwitch=function(){var t=this;clearInterval(this.autoInterval);if(this.commList.length>1)this.autoInterval=setInterval(function(){if(t.commList.length-1===t.currIdx)t.currIdx=0;else t.currIdx++;t.gotoCurrIndex()},5e3)};r.prototype.prev=function(){if(this.switching||!this.upTgEnable)return;this.currIdx--;this.gotoCurrIndex()};r.prototype.next=function(){if(this.switching||!this.downTgEnable)return;this.currIdx++;this.gotoCurrIndex()};r.prototype.gotoCurrIndex=function(){if(this.commList.length-1===this.currIdx){this.downTgEnable=false;this.downTg.addClass("dis")}else if(!this.downTgEnable){this.downTgEnable=true;this.downTg.removeClass("dis")}if(0===this.currIdx){this.upTgEnable=false;this.upTg.addClass("dis")}else if(!this.upTgEnable){this.upTgEnable=true;this.upTg.removeClass("dis")}this.showCurrIndex(this.currIdx)};r.prototype.showCurrIndex=function(){var t=this,e=this.commList[this.currIdx];this.switching=true;this.tit.animate({opacity:0},{duration:100,complete:function(){t.tit.html(e.accountShow+"&nbsp;&nbsp;&nbsp;&nbsp;"+e.createTime);t.tit.animate({opacity:1},{duration:150})}});this.detail.animate({opacity:0},{duration:100,complete:function(){t.switching=false;t.detail.text(e.commentContent);t.detail.animate({opacity:1},{duration:150})}})};r.prototype.showDetail=function(t){this.commObj.addClass("m-excelComm-show")};r.prototype.shrinkDetail=function(t){this.commObj.removeClass("m-excelComm-show")};function l(t,i){var o=this;this.box=t.eq(0);this.reduceNum=e("a.ctrnum-b-rd",this.box);this.addNum=e("a.ctrnum-b-ad",this.box);this.buyNum=e("input.ctrnum-qty",this.box);this.disstyle="ctrnum-b-dis";this.config=e.extend({},i);this.bind_event()}l.prototype.bind_event=function(){var t=this.reduceNum,i=this.addNum,o=this.buyNum,n=this,a=this.config,s=1,r=e("#js_dometxt");this.config.qtyController.$on("limitchange",function(t){r.text()!==t.msg&&r.text(t.msg)});i.click(function(){if(!i.hasClass(n.disstyle))n.numberChange(1)});t.click(function(){if(!t.hasClass(n.disstyle))n.numberChange(-1)});o.focusout(function(){n.numberChange(0)})};l.prototype.numberChange=function(t){var e=this.config.qtyController.getLimitsInfo(),i=parseInt(this.buyNum.val(),10)||1,o=e.maxQty,n=e.minQty;this.reduceNum.removeClass(this.disstyle);this.addNum.removeClass(this.disstyle);i+=t;if(n<o){if(i<=n){i=n;this.reduceNum.addClass(this.disstyle)}else if(i>n&&i<o);else if(i>=o){i=o;this.addNum.addClass(this.disstyle)}this.toggleBuyAndCart(true)}else{if(n>1)i=n;else i=o;this.reduceNum.addClass(this.disstyle);this.addNum.addClass(this.disstyle);if(n>o)this.toggleBuyAndCart(false);else this.toggleBuyAndCart(true)}this.buyNum.val(i);this.checkOverAmount()},l.prototype.toggleBuyAndCart=function(){var t=e("#buyBtn, #addCart,.aBuyBtn,.aAddCart");return function(e){this.isBuyBtnsEnable=e;if(e)t.removeClass("disabled");else t.addClass("disabled")}}();l.prototype.checkOverAmount=function(){var t=e("#j_buyboxnum"),i=t.attr("data-it"),o=parseFloat(t.attr("data-maxamount"))||0;if("3"===i||"2"===i)return;var n=parseInt(this.buyNum.val(),10)||0,a=parseFloat(e("#js_skuBox").parent().find("[name='goods[0].tempCurrentPrice']").val());if(1!=n&&a*n>o){e("#js_overAmountTip").removeClass("hide");e("#buyBtn, .aBuyBtn").addClass("disabled")}else{e("#js_overAmountTip").addClass("hide");if(this.isBuyBtnsEnable)e("#buyBtn, .aBuyBtn").removeClass("disabled")}};var c=function(){var t,n={init:function(o){t=e("#js_skuBox");n.qtyController=o.qtyController;if(!i.sku_map)return;e(".skuBox",t).length&&n.bind_event();n.skupvs=e.getUrlPara("skupvs")||"";if(!i.promotionAsync.loaded)i.promotionAsync.callbackFns.push(function(){n.init_view();n._triggerSkuPvs()});else{n.init_view();n._triggerSkuPvs()}},_triggerSkuPvs:function(){e.each(n.skupvs.split("_"),function(i,o){e("li[vid="+o+"]",t).trigger("click")})},bind_event:function(){e("li[vid]",t).click(function(){if(e(this).hasClass("disabledLi"))return;n.select_sku(e(this));if(e("div.skuBox",t).length==e("li.selectedLi",t).length)t.children(".skuWrap").removeClass("errBox")})},select_sku:function(o){if(!i.promotionAsync.loaded)return;var a=o.parent(),s=o.attr("vid"),r=o.attr("imgurl")||"";if(r){e("#showImg").attr("src",i.getImgThumbnail(r,400));e("#litimgUl li.active").removeClass("active");e("#showImgBig").attr("src",i.getImgThumbnail(r,800));e("#showLocalImg").attr("href",i.getImgThumbnail(r,800))}if(o.hasClass("selectedLi")){o.removeClass("selectedLi");n.init_view();e("input.ctrnum-qty",t).trigger("focusout");n.setImgSkuDesc(o,0);return}e("li.selectedLi",a).removeClass("selectedLi");o.addClass("selectedLi");n.setImgSkuDesc(o,1);n.update_view()},setImgSkuDesc:function(t,e){var i=t.nextAll(".selectedImgDesc").eq(0);if(i.length>0){if(0==e){i.hide();return}i.find(".selectedDesc").text(t.attr("title"));i.show()}},__getDefSku:function(){var t=[],o=n.skupvs,a;if(!o)return;e.each(o.split("_"),function(e,i){if(!!i)t.push(i)});a=n.get_key(t);return i.promotionAsync.skuVidMap[a]},initDefHideTomorrowArrival:function(){var t=n.__getDefSku(),e,o;var a=i.promotionAsync.skuVidMap||{};e=true;for(var s in a)if(a.hasOwnProperty(s)&&!a[s].preSaleRemindStr)e=false;o=!!t&&!!t.preSaleRemindStr;i.__isInitHideTomorrowArrival=o||e;i.__isDefHideTomorrowArrival=e},getCurAsyncSku:function(){var o=e("li.selectedLi",t),a=[],s,r;o.each(function(){a.push(e(this).attr("vid"))});s=n.get_key(a);r=i.promotionAsync.skuVidMap[s];return r},update_view:function(){var a=e("li.selectedLi",t),s=[],r,l,c,u,d=true;a.each(function(){s.push(e(this).attr("vid"))});c=n.get_key(s),u=i.sku_map[c];n.qtyController.skuChange(c);if(u){r=i.promotionAsync.skuIdMap[u.skuId];i.__refreshDiscountMarketprice(+r.currentPrice,+r.marketPrice);l=+r.currentPrice;i.promotionTitle&&i.promotionTitle.$emit("changeSku",u.skuId);var f=[],m=[];if(1==parseFloat(r.actualStorageStatus||0)&&parseFloat(r.currentStore||0)>0)(parseFloat(u.appOnlyPriceIncrement)||0)>0&&f.push((parseFloat(l)||0)-(parseFloat(u.appOnlyPriceIncrement)||0));(parseFloat(u.appTemaiPriceIncrement)||0)>0&&m.push((parseFloat(l)||0)-(parseFloat(u.appTemaiPriceIncrement)||0));n.update_app_pmo_process(f,m);var p=e("#buyBtn").closest("form").find("[name='goods[0].tempCurrentPrice']");p&&p.val(l);!!i.__dealCoutingDownBanner&&i.__dealCoutingDownBanner(c)}else!!i.__dealCoutingDownBanner&&i.__dealCoutingDownBanner();u&&e("#js_skuTaxRate").text((100*parseFloat(u.taxRate)).Round(3)+"%");u&&e("#js_kaolaprice").length>0&&e("#js_kaolaprice").text(i.getPriceStr(+u.suggestPrice));u&&e("#js_preprice").length>0&&u.promotionPreprice!==o&&e("#js_preprice").text(i.getPriceStr(+u.promotionPreprice));u&&e("input[name=goods[0].skuId]").val(u.skuId||"0");n.set_disabled();var h=e("#yushou",".PInfo"),g=e(".m-price .m-price-title"),v=e(".j-tomorrowArrival");if(r&&r.preSaleRemindStr){i.__isSkuHideTomorrowArrival=true;v.slideUp();h.find(".m-yushou-msg").text(r.preSaleRemindStr);h.slideDown();g.text("预售价")}else{i.__isSkuHideTomorrowArrival=false;if(r&&i.__tomorrowArrivalShow||!i.__isDefHideTomorrowArrival&&i.__tomorrowArrivalShow)v.slideDown();h.slideUp();if("预售价"==g.text())g.text("售价")}if(!!u&&0==n.qtyController.getStore(c))i.switchNoGoods("show");else i.switchNoGoods("hide");e("input.ctrnum-qty",t).trigger("focusout")},get_now_vid:function(){var o,a;if(0===e(".skuBox",t).length)for(a in i.sku_map){if(!i.sku_map.hasOwnProperty(a))continue;o=a;break}else{var s=[],r=e("li.selectedLi",t);r.each(function(){s.push(e(this).attr("vid"))});o=n.get_key(s)}return o},set_disabled:function(){var o=e("div.skuBox",t),a=o.find("li[vid]");if(0==o.length)return;for(var s=0,r=a.length,l,c;s<r;s++){c=e(a[s]);l=c.closest("div.skuBox");var u=m(l,c),d=h(u),f=c.hasClass("selectedLi")||p(u);!!d?c.addClass("stockout"):c.removeClass("stockout");!f?c.addClass("disabledLi"):c.removeClass("disabledLi")}function m(t,i){var n=[];o.not(t).find("li[vid].selectedLi").each(function(){n.push(e(this).attr("vid"))});n.push(i.attr("vid"));return n}function p(t){if(t.length==o.length)return!!i.sku_map[n.get_key(t)];var a=[];o.not(l).each(function(){var t=e(this),i=[];if(t.find("li[vid].selectedLi").length>0)return;t.find("li[vid]").each(function(){i.push(e(this).attr("vid"))});a.push(i)});var s=a.length;var r=[];var c=[];!function m(t){if(t>s-1)return;for(c[t]=0;c[t]<a[t].length;c[t]++){m(t+1);if(t==s-1){var e=[];for(var i=s-1;i>=0;i--)e.push(a[t-i][c[t-i]]);r.push(e)}}}(0);for(var u=0,d=r.length,f;u<d;u++){f=t.concat(r[u]);if(!!i.sku_map[n.get_key(f)])return true}return false}function h(t){var e=n.get_key(t);if(!n.qtyController)return false;return n.qtyController.getStore(e)<=0}},get_key:function(t){if(!(t instanceof Array)||0==t.length)return"";t.sort(function(t,e){return parseInt(t,10)-parseInt(e,10)});return"_"+t.join("_")},update_app_pmo_process:function(t,o){var n=e(".m-app-act-pmt"),a=n.attr("data-type");if(0===n.length||!a)return;var s="apptemai"===a?o:t;if(s&&0===s.length){n.hide();return}s=s.sort(function(t,e){return parseFloat(t,10)-parseFloat(e,10)});if(s[0]==s[s.length-1])this.update_app_promotion(s[0]);else this.update_app_promotion(s[0],s[s.length-1]);!!i.__asyncSkuInfoReceived&&n.not(":visible").show()},update_app_promotion:function(t,o){var n=e(".m-app-act-pmt .desc .num"),a,s;if(0===n.length)return;a="number"===typeof t?i.getPriceStr(t):"";s="number"===typeof o?i.getPriceStr(o):"";n.text("¥"+a+(!!s?"-"+s:""))},init_view:function(){var o=i.sku_map,a={},s=[],r=[],l=[],c=[],u=[],d=i.promotionAsync.skuIdMap||{},f,m,p=0,h,g,v;i.promotionTitle&&i.promotionTitle.$emit("changeSku");for(f in o){p++;m=o[f];g=d[m.skuId];v=g.currentPrice||0;s.push(parseFloat(m.taxRate||0));r.push(parseFloat(m.taxRate||0)*parseFloat(v||0));l.push(parseFloat(m.suggestPrice||0));if(1==parseFloat(g.actualStorageStatus||0)&&parseFloat(g.currentStore||0)>0)parseFloat(m.appOnlyPriceIncrement||0)>0&&c.push(parseFloat(v)-parseFloat(m.appOnlyPriceIncrement||0));parseFloat(m.appTemaiPriceIncrement||0)>0&&u.push(parseFloat(v)-parseFloat(m.appTemaiPriceIncrement||0))}i.__refreshDiscountMarketprice(+i.promotionAsync.result.currentPrice,+i.promotionAsync.result.marketPrice);if(s.sort(function(t,e){return parseFloat(t,10)-parseFloat(e,10)}).length)if(s[0]==s[s.length-1])e("#js_skuTaxRate").text((100*s[0]).Round(3)+"%");else e("#js_skuTaxRate").text((100*s[0]).Round(3)+"%-"+100*s[s.length-1]+"%");if(e("#js_kaolaprice").length>0&&l.sort(function(t,e){return parseFloat(t,10)-parseFloat(e,10)}).length)if(l[0]==l[l.length-1])e("#js_kaolaprice").text(i.getPriceStr(l[0]));else e("#js_kaolaprice").text(i.getPriceStr(l[0])+"-"+i.getPriceStr(l.pop()));n.update_app_pmo_process(c,u);var y=e("#yushou",".PInfo"),_=e(".m-price .m-price-title"),w=e("div.skuBox",t),k=e(".j-tomorrowArrival");var x=0==w.length&&!!g&&g.preSaleRemindStr;i.__isSkuHideTomorrowArrival=false;if(i.__tomorrowArrivalShow&&!x&&!i.__isDefHideTomorrowArrival)k.slideDown();else{if(x)i.__isSkuHideTomorrowArrival=true;k.slideUp()}if(x){y.find(".m-yushou-msg").text(g.preSaleRemindStr);y.show();_.text("预售价")}else if(y.css("display").indexOf("none")<0){y.slideUp();if("预售价"==_.text())_.text("售价")}var b=n.get_now_vid();n.qtyController.skuChange(b);!!i.__dealCoutingDownBanner&&i.__dealCoutingDownBanner();e("[name=js_buyBox] input.ctrnum-qty").trigger("focusout");n.set_disabled();if(0==n.qtyController.getStore(b)&&0==e(".skuBox",t).length)i.switchNoGoods("show");else i.switchNoGoods("hide")},check:function(){if(0==e(".skuBox",t).length)return true;if(e("div.skuBox",t).length!=e("li.selectedLi",t).length){t.children(".skuWrap").addClass("errBox");return false}else if(parseInt(e("#js_dome").text(),10)<1||0==e.trim(e("input.ctrnum-qty",t).val())){e("input.ctrnum-qty",t).trigger("focusout");t.children(".skuWrap").addClass("errBox");return false}else{t.children(".skuWrap").removeClass("errBox");return true}}};return n}()}(window,jQuery,Core);
!function(t,a,e){function i(t,a,e,i,n,p,s){this.htmlTmpl={noPrevPage:'<span class="prevPage">上一页<i></i></span>',prevPage:'<a class="prevPage" href="javascript:void(0);" data-page="{0}">上一页<i></i></a>',itemPage:'<a href="javascript:void(0);" data-page="{0}">{0}</a>',itemActive:"<span>{0}</span>",pageSplit:"<em>...</em> ",noNextPage:'<span class="nextPage">下一页<i></i></span>',nextPage:'<a class="nextPage" href="javascript:void(0);" data-page="{0}">下一页<i></i></a>',jumpInfo:'&nbsp;<span class="jumptoTip">到第</span><input class="jumptoTxt" type="text" value=""><span class="jumptoTip">页</span><a class="jumptoBtn" href="javascript:void(0);">确定</a>'};this.init(t,a,e,i,n,p,s)}var n=i.prototype;n.getLinkRange=function(t,e,i){var n=[],p=t,s=0;for(;p<=e;p++)n[s++]=a.format(this.htmlTmpl[p==i?"itemActive":"itemPage"],p);return n.join("")};n.MakeHTML=function(t,e,i,n,p){var s=[i>1?a.format(this.htmlTmpl["prevPage"],i-1):this.htmlTmpl.noPrevPage],g=2*n+2,p=p||10;if(e<=g+1)s[1]=this.getLinkRange(1,e,i);else if(i<n+3){s[1]=this.getLinkRange(1,g,i);s[2]=this.htmlTmpl.pageSplit;s[3]=this.getLinkRange(e,e,i)}else if(i>e-n-2){s[1]=this.getLinkRange(1,1,i);s[2]=this.htmlTmpl.pageSplit;s[3]=this.getLinkRange(e-g+1,e,i)}else{s[1]=this.getLinkRange(1,1,i);s[2]=this.htmlTmpl.pageSplit;s[3]=this.getLinkRange(i-n,i+n,i);s[4]=this.htmlTmpl.pageSplit;s[5]=this.getLinkRange(e,e,i)}s.push(i!=e?a.format(this.htmlTmpl["nextPage"],i+1):this.htmlTmpl.noNextPage);if(e>p)s.push(this.htmlTmpl.jumpInfo);return a.format(s.join(""),{maxRecordNum:t,currentPage:i,totalPage:e})};n.init=function(t,e,i,n,p,s,g){var l=s||1,m=parseInt(e/i)+(e%i?1:0),h=function(){},r=a(t);if(m<=1){r.hide();return}a("a",r).unbind();r.html(this.MakeHTML(e,m,n,l,g));h=p||h;a("a[data-page]",r).click(function(){h(a(this).attr("data-page"))});a("a.jumptoBtn",r).click(function(){var t=parseInt(a("input",r).val())||0;t=t>m?m:t;t=t<1?1:t;h(t)})};Core.pageStr=function(t,a,e,n,p,s,g){new i(t,a,e,n,p,s,g)}}(window,jQuery);
Core.PCarousel=Regular.extend({template:"#addFavDlgCarousel",config:function(){var a=this,t=a.data;t.goodsList=t.goodsList||[];t.pages=[];t.current=0;t.size=t.size||3;var n=t.size,e=t.goodsList.length,r=parseInt(e/n);if(r*n<e)r++;for(var i=0,s=r;i<s;i++)t.pages.push(0);t.scrollbarWidth=120*e+10;t.left=0},__scrollLeft:function(){var a=this,t=a.data,n=t.dspushScroll;if(0==t.current||!!t.animating)return;!!window._dapush&&!!n&&window._dapush("_trackEvent",n[0],n[1],n[2],{userAccount:window.easyNav.account||"",userId:window.easyNav.account||""});t.left-=120*t.size;var e=$(a.$refs.scrollbar);t.animating=true;e.animate({left:"-"+t.left+"px"},500,"swing",function(){t.current--;t.animating=false;a.$update()})},__scrollRight:function(){var a=this,t=a.data,n=t.dspushScroll;if(t.current==t.pages.length-1||!!t.animating)return;!!window._dapush&&!!n&&window._dapush("_trackEvent",n[0],n[1],n[2],{userAccount:window.easyNav.account||"",userId:window.easyNav.account||""});t.left+=120*t.size;var e=$(a.$refs.scrollbar);t.animating=true;e.animate({left:"-"+t.left+"px"},500,"swing",function(){t.current++;t.animating=false;a.$update()})}}).filter({price:function(a){return(a||0).Round(2)}});